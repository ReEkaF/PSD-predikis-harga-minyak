
<!DOCTYPE html>


<html lang="en" data-content_root="./" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>PREDIKSI HARGA MINYAK CURAH UNTUK MENINGKATKAN KEUNTUNGAN DAN MENGURANGI KERUGIAN &#8212; Prediksi harga minyak goreng curah</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "light";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="_static/styles/theme.css?digest=8d27b9dea8ad943066ae" rel="stylesheet" />
<link href="_static/styles/bootstrap.css?digest=8d27b9dea8ad943066ae" rel="stylesheet" />
<link href="_static/styles/pydata-sphinx-theme.css?digest=8d27b9dea8ad943066ae" rel="stylesheet" />

  
  <link href="_static/vendor/fontawesome/6.5.1/css/all.min.css?digest=8d27b9dea8ad943066ae" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.5.1/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.5.1/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.5.1/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="_static/pygments.css?v=fa44fd50" />
    <link rel="stylesheet" type="text/css" href="_static/styles/sphinx-book-theme.css?v=384b581d" />
    <link rel="stylesheet" type="text/css" href="_static/togglebutton.css?v=13237357" />
    <link rel="stylesheet" type="text/css" href="_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-thebe.css?v=4fa983c6" />
    <link rel="stylesheet" type="text/css" href="_static/design-style.1e8bd061cd6da7fc9cf755528e8ffc24.min.css?v=0a3b3ea7" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="_static/scripts/bootstrap.js?digest=8d27b9dea8ad943066ae" />
<link rel="preload" as="script" href="_static/scripts/pydata-sphinx-theme.js?digest=8d27b9dea8ad943066ae" />
  <script src="_static/vendor/fontawesome/6.5.1/js/all.min.js?digest=8d27b9dea8ad943066ae"></script>

    <script src="_static/documentation_options.js?v=9eb32ce0"></script>
    <script src="_static/doctools.js?v=888ff710"></script>
    <script src="_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="_static/copybutton.js?v=f281be69"></script>
    <script src="_static/scripts/sphinx-book-theme.js?v=efea14e4"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="_static/togglebutton.js?v=4a39c7ea"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="_static/design-tabs.js?v=36754332"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script async="async" src="_static/sphinx-thebe.js?v=c100c467"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'Proyek_sains_data';</script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="prev" title="Proyek Data Sains" href="intro.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <a id="pst-skip-link" class="skip-link" href="#main-content">Skip to main content</a>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>
    Back to top
  </button>

  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__primary"
          id="__primary"/>
  <label class="overlay overlay-primary" for="__primary"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__secondary"
          id="__secondary"/>
  <label class="overlay overlay-secondary" for="__secondary"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search this book..."
         aria-label="Search this book..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>
  
    <header class="bd-header navbar navbar-expand-lg bd-navbar">
    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">

  

<a class="navbar-brand logo" href="intro.html">
  
  
  
  
  
    
    
      
    
    
    <img src="_static/logo.png" class="logo__image only-light" alt="Prediksi harga minyak goreng curah - Home"/>
    <script>document.write(`<img src="_static/logo.png" class="logo__image only-dark" alt="Prediksi harga minyak goreng curah - Home"/>`);</script>
  
  
</a></div>
        <div class="sidebar-primary-item">

 <script>
 document.write(`
   <button class="btn navbar-btn search-button-field search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
    <span class="search-button__default-text">Search</span>
    <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
   </button>
 `);
 </script></div>
        <div class="sidebar-primary-item"><nav class="bd-links bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="intro.html">
                    Proyek Data Sains
                </a>
            </li>
        </ul>
        <ul class="current nav bd-sidenav">
<li class="toctree-l1 current active"><a class="current reference internal" href="#">PREDIKSI HARGA MINYAK CURAH UNTUK MENINGKATKAN KEUNTUNGAN DAN MENGURANGI KERUGIAN</a></li>

</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><label class="sidebar-toggle primary-toggle btn btn-sm" for="__primary" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</label></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-source-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Source repositories">
    <i class="fab fa-github"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://github.com/executablebooks/jupyter-book" target="_blank"
   class="btn btn-sm btn-source-repository-button dropdown-item"
   title="Source repository"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="btn__text-container">Repository</span>
</a>
</li>
      
      
      
      
      <li><a href="https://github.com/executablebooks/jupyter-book/issues/new?title=Issue%20on%20page%20%2FProyek_sains_data.html&body=Your%20issue%20content%20here." target="_blank"
   class="btn btn-sm btn-source-issues-button dropdown-item"
   title="Open an issue"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="btn__text-container">Open issue</span>
</a>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="_sources/Proyek_sains_data.ipynb" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.ipynb</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>



<script>
document.write(`
  <button class="btn btn-sm navbar-btn theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="theme-switch nav-link" data-mode="light"><i class="fa-solid fa-sun fa-lg"></i></span>
    <span class="theme-switch nav-link" data-mode="dark"><i class="fa-solid fa-moon fa-lg"></i></span>
    <span class="theme-switch nav-link" data-mode="auto"><i class="fa-solid fa-circle-half-stroke fa-lg"></i></span>
  </button>
`);
</script>


<script>
document.write(`
  <button class="btn btn-sm navbar-btn search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
  </button>
`);
</script>
<label class="sidebar-toggle secondary-toggle btn btn-sm" for="__secondary"title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</label>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>PREDIKSI HARGA MINYAK CURAH UNTUK MENINGKATKAN KEUNTUNGAN DAN MENGURANGI KERUGIAN</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#">PREDIKSI HARGA MINYAK CURAH UNTUK MENINGKATKAN KEUNTUNGAN DAN MENGURANGI KERUGIAN</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#perhitungan-manual-lstm">perhitungan manual LSTM</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#link-deploy-model-dengan-pythonanywere">link deploy model dengan pythonanywere</a></li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#pembahasan">PEMBAHASAN</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#data-understanding">1. DATA UNDERSTANDING</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#sumber-data">SUMBER DATA</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#eksplorasi-data">EKSPLORASI DATA</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#visualisasi-data">Visualisasi Data</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#struktur-dataset">STRUKTUR DATASET</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#identifikasi-kualitas-data">IDENTIFIKASI KUALITAS DATA</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#pendeteksian-missing-value">PENDETEKSIAN MISSING VALUE</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#sliding-windows">Sliding Windows</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#modelling-dengan-regresi-linier">MODELLING DENGAN REGRESI LINIER</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#mencoba-menggunakan-model-lain-lstm">mencoba menggunakan model lain(LSTM)</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#regresi-linier-dengan-ensemble-begging">Regresi linier dengan ensemble begging</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#grid-search">Grid Search</a></li>
</ul>
</li>
</ul>

            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <section class="tex2jax_ignore mathjax_ignore" id="prediksi-harga-minyak-curah-untuk-meningkatkan-keuntungan-dan-mengurangi-kerugian">
<h1>PREDIKSI HARGA MINYAK CURAH UNTUK MENINGKATKAN KEUNTUNGAN DAN MENGURANGI KERUGIAN<a class="headerlink" href="#prediksi-harga-minyak-curah-untuk-meningkatkan-keuntungan-dan-mengurangi-kerugian" title="Link to this heading">#</a></h1>
<section id="perhitungan-manual-lstm">
<h2>perhitungan manual LSTM<a class="headerlink" href="#perhitungan-manual-lstm" title="Link to this heading">#</a></h2>
<p><a class="reference external" href="https://docs.google.com/spreadsheets/d/1mU8McgIlnW_rGjJQXjTY6Rpmtch7xCKh6rC0MkyZW6s/edit?usp=sharing">https://docs.google.com/spreadsheets/d/1mU8McgIlnW_rGjJQXjTY6Rpmtch7xCKh6rC0MkyZW6s/edit?usp=sharing</a></p>
</section>
<section id="link-deploy-model-dengan-pythonanywere">
<h2>link deploy model dengan pythonanywere<a class="headerlink" href="#link-deploy-model-dengan-pythonanywere" title="Link to this heading">#</a></h2>
<p><a class="reference external" href="https://rekafferdi.pythonanywhere.com/">https://rekafferdi.pythonanywhere.com/</a></p>
<p>Tujuan</p>
<p>Penelitina ini bertujuan untuk mengetahui peningkatan atau penurunan harga pasar dalam 1 minggu kedepan agar suatu distibutor dapat mennggunakannnya untuk memprediksi harga kedepannya agar dapat meningkatkan pendapatan dan meminimalisir kerugian</p>
</section>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="pembahasan">
<h1>PEMBAHASAN<a class="headerlink" href="#pembahasan" title="Link to this heading">#</a></h1>
<section id="data-understanding">
<h2>1. DATA UNDERSTANDING<a class="headerlink" href="#data-understanding" title="Link to this heading">#</a></h2>
</section>
<section id="sumber-data">
<h2>SUMBER DATA<a class="headerlink" href="#sumber-data" title="Link to this heading">#</a></h2>
<p>Data diperoleh dari Bank Indonesia mengenai harga pangan dan dapat diakses dengan link berikut <a class="reference external" href="https://www.bi.go.id/hargapangan">https://www.bi.go.id/hargapangan</a></p>
<section id="eksplorasi-data">
<h3>EKSPLORASI DATA<a class="headerlink" href="#eksplorasi-data" title="Link to this heading">#</a></h3>
</section>
<section id="visualisasi-data">
<h3>Visualisasi Data<a class="headerlink" href="#visualisasi-data" title="Link to this heading">#</a></h3>
<p>untuk memudahkan kita dalam memahami dataset ,ada baiknya kita ditampilkan dengan visual yang dapat dipahami oleh semua orang,pada visualisasi merupakan tahap awal kita dalam memahami dataset.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="c1"># Baca file CSV</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;minyak_many.csv&#39;</span><span class="p">)</span>
<span class="c1"># Membuat plot dengan matplotlib</span>
<span class="c1"># plt.figure(figsize=(16 ,8))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">32</span> <span class="p">,</span><span class="mi">16</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;Date&#39;</span><span class="p">],</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;minggu&#39;</span><span class="p">],</span> <span class="n">marker</span><span class="o">=</span><span class="s1">&#39;o&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Beras&#39;</span><span class="p">)</span>
<span class="c1"># Menambahkan judul dan label sumbu</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Harga Beras per Minggu di Pasar Jawa Timur&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Tanggal&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Harga (Rp)&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xticks</span><span class="p">(</span><span class="n">rotation</span><span class="o">=</span><span class="mi">45</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
<span class="c1"># Menampilkan plot</span>
<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
<span class="n">data</span><span class="o">=</span><span class="n">df</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output traceback highlight-ipythontb notranslate"><div class="highlight"><pre><span></span><span class="gt">---------------------------------------------------------------------------</span>
<span class="ne">FileNotFoundError</span><span class="g g-Whitespace">                         </span>Traceback (most recent call last)
<span class="n">Cell</span> <span class="n">In</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">line</span> <span class="mi">5</span>
<span class="g g-Whitespace">      </span><span class="mi">3</span> <span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="g g-Whitespace">      </span><span class="mi">4</span> <span class="c1"># Baca file CSV</span>
<span class="ne">----&gt; </span><span class="mi">5</span> <span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;minyak_many.csv&#39;</span><span class="p">)</span>
<span class="g g-Whitespace">      </span><span class="mi">6</span> <span class="c1"># Membuat plot dengan matplotlib</span>
<span class="g g-Whitespace">      </span><span class="mi">7</span> <span class="c1"># plt.figure(figsize=(16 ,8))</span>
<span class="g g-Whitespace">      </span><span class="mi">8</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">32</span> <span class="p">,</span><span class="mi">16</span><span class="p">))</span>

<span class="nn">File ~\AppData\Local\Programs\Python\Python312\Lib\site-packages\pandas\io\parsers\readers.py:1026,</span> in <span class="ni">read_csv</span><span class="nt">(filepath_or_buffer, sep, delimiter, header, names, index_col, usecols, dtype, engine, converters, true_values, false_values, skipinitialspace, skiprows, skipfooter, nrows, na_values, keep_default_na, na_filter, verbose, skip_blank_lines, parse_dates, infer_datetime_format, keep_date_col, date_parser, date_format, dayfirst, cache_dates, iterator, chunksize, compression, thousands, decimal, lineterminator, quotechar, quoting, doublequote, escapechar, comment, encoding, encoding_errors, dialect, on_bad_lines, delim_whitespace, low_memory, memory_map, float_precision, storage_options, dtype_backend)</span>
<span class="g g-Whitespace">   </span><span class="mi">1013</span> <span class="n">kwds_defaults</span> <span class="o">=</span> <span class="n">_refine_defaults_read</span><span class="p">(</span>
<span class="g g-Whitespace">   </span><span class="mi">1014</span>     <span class="n">dialect</span><span class="p">,</span>
<span class="g g-Whitespace">   </span><span class="mi">1015</span>     <span class="n">delimiter</span><span class="p">,</span>
   <span class="p">(</span><span class="o">...</span><span class="p">)</span>
<span class="g g-Whitespace">   </span><span class="mi">1022</span>     <span class="n">dtype_backend</span><span class="o">=</span><span class="n">dtype_backend</span><span class="p">,</span>
<span class="g g-Whitespace">   </span><span class="mi">1023</span> <span class="p">)</span>
<span class="g g-Whitespace">   </span><span class="mi">1024</span> <span class="n">kwds</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">kwds_defaults</span><span class="p">)</span>
<span class="ne">-&gt; </span><span class="mi">1026</span> <span class="k">return</span> <span class="n">_read</span><span class="p">(</span><span class="n">filepath_or_buffer</span><span class="p">,</span> <span class="n">kwds</span><span class="p">)</span>

<span class="nn">File ~\AppData\Local\Programs\Python\Python312\Lib\site-packages\pandas\io\parsers\readers.py:620,</span> in <span class="ni">_read</span><span class="nt">(filepath_or_buffer, kwds)</span>
<span class="g g-Whitespace">    </span><span class="mi">617</span> <span class="n">_validate_names</span><span class="p">(</span><span class="n">kwds</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;names&quot;</span><span class="p">,</span> <span class="kc">None</span><span class="p">))</span>
<span class="g g-Whitespace">    </span><span class="mi">619</span> <span class="c1"># Create the parser.</span>
<span class="ne">--&gt; </span><span class="mi">620</span> <span class="n">parser</span> <span class="o">=</span> <span class="n">TextFileReader</span><span class="p">(</span><span class="n">filepath_or_buffer</span><span class="p">,</span> <span class="o">**</span><span class="n">kwds</span><span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">622</span> <span class="k">if</span> <span class="n">chunksize</span> <span class="ow">or</span> <span class="n">iterator</span><span class="p">:</span>
<span class="g g-Whitespace">    </span><span class="mi">623</span>     <span class="k">return</span> <span class="n">parser</span>

<span class="nn">File ~\AppData\Local\Programs\Python\Python312\Lib\site-packages\pandas\io\parsers\readers.py:1620,</span> in <span class="ni">TextFileReader.__init__</span><span class="nt">(self, f, engine, **kwds)</span>
<span class="g g-Whitespace">   </span><span class="mi">1617</span>     <span class="bp">self</span><span class="o">.</span><span class="n">options</span><span class="p">[</span><span class="s2">&quot;has_index_names&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">kwds</span><span class="p">[</span><span class="s2">&quot;has_index_names&quot;</span><span class="p">]</span>
<span class="g g-Whitespace">   </span><span class="mi">1619</span> <span class="bp">self</span><span class="o">.</span><span class="n">handles</span><span class="p">:</span> <span class="n">IOHandles</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span>
<span class="ne">-&gt; </span><span class="mi">1620</span> <span class="bp">self</span><span class="o">.</span><span class="n">_engine</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_make_engine</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">engine</span><span class="p">)</span>

<span class="nn">File ~\AppData\Local\Programs\Python\Python312\Lib\site-packages\pandas\io\parsers\readers.py:1880,</span> in <span class="ni">TextFileReader._make_engine</span><span class="nt">(self, f, engine)</span>
<span class="g g-Whitespace">   </span><span class="mi">1878</span>     <span class="k">if</span> <span class="s2">&quot;b&quot;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">mode</span><span class="p">:</span>
<span class="g g-Whitespace">   </span><span class="mi">1879</span>         <span class="n">mode</span> <span class="o">+=</span> <span class="s2">&quot;b&quot;</span>
<span class="ne">-&gt; </span><span class="mi">1880</span> <span class="bp">self</span><span class="o">.</span><span class="n">handles</span> <span class="o">=</span> <span class="n">get_handle</span><span class="p">(</span>
<span class="g g-Whitespace">   </span><span class="mi">1881</span>     <span class="n">f</span><span class="p">,</span>
<span class="g g-Whitespace">   </span><span class="mi">1882</span>     <span class="n">mode</span><span class="p">,</span>
<span class="g g-Whitespace">   </span><span class="mi">1883</span>     <span class="n">encoding</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">options</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;encoding&quot;</span><span class="p">,</span> <span class="kc">None</span><span class="p">),</span>
<span class="g g-Whitespace">   </span><span class="mi">1884</span>     <span class="n">compression</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">options</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;compression&quot;</span><span class="p">,</span> <span class="kc">None</span><span class="p">),</span>
<span class="g g-Whitespace">   </span><span class="mi">1885</span>     <span class="n">memory_map</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">options</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;memory_map&quot;</span><span class="p">,</span> <span class="kc">False</span><span class="p">),</span>
<span class="g g-Whitespace">   </span><span class="mi">1886</span>     <span class="n">is_text</span><span class="o">=</span><span class="n">is_text</span><span class="p">,</span>
<span class="g g-Whitespace">   </span><span class="mi">1887</span>     <span class="n">errors</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">options</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;encoding_errors&quot;</span><span class="p">,</span> <span class="s2">&quot;strict&quot;</span><span class="p">),</span>
<span class="g g-Whitespace">   </span><span class="mi">1888</span>     <span class="n">storage_options</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">options</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;storage_options&quot;</span><span class="p">,</span> <span class="kc">None</span><span class="p">),</span>
<span class="g g-Whitespace">   </span><span class="mi">1889</span> <span class="p">)</span>
<span class="g g-Whitespace">   </span><span class="mi">1890</span> <span class="k">assert</span> <span class="bp">self</span><span class="o">.</span><span class="n">handles</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span>
<span class="g g-Whitespace">   </span><span class="mi">1891</span> <span class="n">f</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">handles</span><span class="o">.</span><span class="n">handle</span>

<span class="nn">File ~\AppData\Local\Programs\Python\Python312\Lib\site-packages\pandas\io\common.py:873,</span> in <span class="ni">get_handle</span><span class="nt">(path_or_buf, mode, encoding, compression, memory_map, is_text, errors, storage_options)</span>
<span class="g g-Whitespace">    </span><span class="mi">868</span> <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">handle</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
<span class="g g-Whitespace">    </span><span class="mi">869</span>     <span class="c1"># Check whether the filename is to be opened in binary mode.</span>
<span class="g g-Whitespace">    </span><span class="mi">870</span>     <span class="c1"># Binary mode does not support &#39;encoding&#39; and &#39;newline&#39;.</span>
<span class="g g-Whitespace">    </span><span class="mi">871</span>     <span class="k">if</span> <span class="n">ioargs</span><span class="o">.</span><span class="n">encoding</span> <span class="ow">and</span> <span class="s2">&quot;b&quot;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">ioargs</span><span class="o">.</span><span class="n">mode</span><span class="p">:</span>
<span class="g g-Whitespace">    </span><span class="mi">872</span>         <span class="c1"># Encoding</span>
<span class="ne">--&gt; </span><span class="mi">873</span>         <span class="n">handle</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span>
<span class="g g-Whitespace">    </span><span class="mi">874</span>             <span class="n">handle</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">875</span>             <span class="n">ioargs</span><span class="o">.</span><span class="n">mode</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">876</span>             <span class="n">encoding</span><span class="o">=</span><span class="n">ioargs</span><span class="o">.</span><span class="n">encoding</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">877</span>             <span class="n">errors</span><span class="o">=</span><span class="n">errors</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">878</span>             <span class="n">newline</span><span class="o">=</span><span class="s2">&quot;&quot;</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">879</span>         <span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">880</span>     <span class="k">else</span><span class="p">:</span>
<span class="g g-Whitespace">    </span><span class="mi">881</span>         <span class="c1"># Binary mode</span>
<span class="g g-Whitespace">    </span><span class="mi">882</span>         <span class="n">handle</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="n">handle</span><span class="p">,</span> <span class="n">ioargs</span><span class="o">.</span><span class="n">mode</span><span class="p">)</span>

<span class="ne">FileNotFoundError</span>: [Errno 2] No such file or directory: &#39;minyak_many.csv&#39;
</pre></div>
</div>
</div>
</div>
</section>
</section>
<section id="struktur-dataset">
<h2>STRUKTUR DATASET<a class="headerlink" href="#struktur-dataset" title="Link to this heading">#</a></h2>
<p>Dataset ini merupakan dataset dengan tipe time series, sehingga tidak ada label seperti yang umumnya ditemukan pada dataset klasifikasi atau regresi. Dalam konteks time series, data diorganisasikan berdasarkan urutan waktu, dan setiap entri biasanya mewakili pengamatan pada titik waktu tertentu.
Karena tidak ada label,time series pada dataset ini hanya terdiri dari:</p>
<ul class="simple">
<li><p><strong>Waktu</strong> waktu tertentu dalam data</p></li>
<li><p><strong>minyak curah</strong> yang menunjukkan harga minyak curah pada waktu tertentu</p></li>
</ul>
<p>struktur dataset perlu kita ketahui juga untuk mengelola data nantinya,kita perlu megetahui apakah ada berapa data pada dataset,dan ada berapa fitur juga.Karena data dan fitur akan sangat berhubungan dengan model yang akan kita buat nantinya.berikut cara untuk mengetahui struktur data dan penjelasannya.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">shape</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(209, 2)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">columns</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Index([&#39;Date&#39;, &#39;minggu&#39;], dtype=&#39;object&#39;)
</pre></div>
</div>
</div>
</div>
<p>Penjelasan lebih lengkapnya:</p>
<ul class="simple">
<li><p><strong>Waktu</strong> merupakan waktu pada data timeseries yang memiliki rentang 7 hari atau satu minggu antar data sehingga dapat dikatakan bahwa data time series ini merupakan data time series mingguan</p></li>
<li><p><strong>minggu</strong> Merupakan harga minyak curah pada waktu tertentu ,harga minyak curah ini merupkan target yang akan kita prediksi nantinya.</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">describe</span><span class="p">())</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>              Date  minggu
count          209     209
unique         209      24
top     10/14/2020  16,750
freq             1      44
</pre></div>
</div>
</div>
</div>
</section>
<section id="identifikasi-kualitas-data">
<h2>IDENTIFIKASI KUALITAS DATA<a class="headerlink" href="#identifikasi-kualitas-data" title="Link to this heading">#</a></h2>
</section>
<section id="pendeteksian-missing-value">
<h2>PENDETEKSIAN MISSING VALUE<a class="headerlink" href="#pendeteksian-missing-value" title="Link to this heading">#</a></h2>
<p>Missing value merupakan data yang hilang pada suatu dataset. Hal ini bisa terjadi oleh beberapa faktor, diantaranya adalah :</p>
<ul class="simple">
<li><p>Interviewer recording error terjadi akibat kelalaian petugas pengumpul data (pewawancara), misalnya ada sejumlah pertanyaan yang terlewatkan</p></li>
<li><p>Respondent inability error terjadi akibat ketidakmampuan responden dalam memberikan jawaban akurat, misalnya karena tidak memahami pertanyaan, bosan atau kelelahan (respondent fatigue) akhirnya responden mengosongkan sejumlah pertanyaan atau berhenti mengisi kuesioner di tengah jalan.</p></li>
<li><p>Unwillingness respondent error terjadi karena responden tidak berkenan memberikan jawaban yang akurat, misalnya pertanyaan soal penghasilan, usia, berat badan, pengalaman melakukan pelanggaran hukum, dll.</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;Date&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">to_datetime</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;Date&#39;</span><span class="p">])</span>

<span class="c1"># Mendeteksi missing value</span>
<span class="n">missing_values</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">isnull</span><span class="p">()</span>

<span class="c1"># Menghitung jumlah missing value di setiap kolom</span>
<span class="n">missing_count</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">isnull</span><span class="p">()</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>

<span class="c1"># Menampilkan hasil</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Missing value detection:</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">missing_values</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Jumlah missing value per kolom:</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">missing_count</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Missing value detection:
       Date  minggu
0    False   False
1    False   False
2    False   False
3    False   False
4    False   False
..     ...     ...
204  False   False
205  False   False
206  False   False
207  False   False
208  False   False

[209 rows x 2 columns]

Jumlah missing value per kolom:
 Date      0
minggu    0
dtype: int64
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">from</span> <span class="nn">sklearn.neighbors</span> <span class="kn">import</span> <span class="n">LocalOutlierFactor</span>

<span class="c1"># Baca file CSV</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;minyak_many.csv&#39;</span><span class="p">)</span>

<span class="c1"># Konversi kolom &#39;Date&#39; ke tipe datetime dan set sebagai index</span>
<span class="n">df</span><span class="p">[</span><span class="s1">&#39;Date&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">to_datetime</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;Date&#39;</span><span class="p">])</span>
<span class="n">df</span><span class="o">.</span><span class="n">set_index</span><span class="p">(</span><span class="s1">&#39;Date&#39;</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="c1"># Bersihkan data kolom &#39;minggu&#39; dengan menghapus koma dan ubah ke tipe float</span>
<span class="n">df</span><span class="p">[</span><span class="s1">&#39;minggu&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;minggu&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;,&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">float</span><span class="p">)</span>

<span class="c1"># Inisialisasi dan jalankan Local Outlier Factor</span>
<span class="n">lof</span> <span class="o">=</span> <span class="n">LocalOutlierFactor</span><span class="p">(</span><span class="n">n_neighbors</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">contamination</span><span class="o">=</span><span class="mf">0.05</span><span class="p">)</span>
<span class="n">df</span><span class="p">[</span><span class="s1">&#39;outlier&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">lof</span><span class="o">.</span><span class="n">fit_predict</span><span class="p">(</span><span class="n">df</span><span class="p">[[</span><span class="s1">&#39;minggu&#39;</span><span class="p">]])</span>

<span class="c1"># Tandai outlier dalam kolom baru</span>
<span class="n">df</span><span class="p">[</span><span class="s1">&#39;outlier&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;outlier&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="kc">True</span><span class="p">,</span> <span class="kc">False</span><span class="p">)</span>

<span class="c1"># Hapus data yang merupakan outlier</span>
<span class="n">df_cleaned</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="o">~</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;outlier&#39;</span><span class="p">]]</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="s1">&#39;outlier&#39;</span><span class="p">)</span>

<span class="c1"># Simpan data yang telah dibersihkan ke file baru</span>
<span class="n">df_cleaned</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="s1">&#39;minyak_cleaned.csv&#39;</span><span class="p">)</span>

<span class="c1"># Visualisasi data dengan outlier</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">14</span><span class="p">,</span> <span class="mi">7</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">index</span><span class="p">,</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;minggu&#39;</span><span class="p">],</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;minggu&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">index</span><span class="p">[</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;outlier&#39;</span><span class="p">]],</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;minggu&#39;</span><span class="p">][</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;outlier&#39;</span><span class="p">]],</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Outlier&#39;</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="s1">&#39;x&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Deteksi Outlier dengan LOF&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Date&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;minggu&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/ac1c9452d51a203d6cc903f27f9c757e034a9b64c7be07585622f3a2346a852c.png" src="_images/ac1c9452d51a203d6cc903f27f9c757e034a9b64c7be07585622f3a2346a852c.png" />
</div>
</div>
</section>
<section id="sliding-windows">
<h2>Sliding Windows<a class="headerlink" href="#sliding-windows" title="Link to this heading">#</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;minyak_cleaned.csv&#39;</span><span class="p">)</span>  <span class="c1"># Membaca file</span>
<span class="n">df</span><span class="p">[</span><span class="s1">&#39;minggu&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;minggu&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;,&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">float</span><span class="p">)</span>  <span class="c1"># Menghilangkan tanda koma  dan mengonversinya menjadi tipe data float</span>
<span class="n">df</span><span class="p">[</span><span class="s1">&#39;Date&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">to_datetime</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;Date&#39;</span><span class="p">])</span>  <span class="c1"># Mengonversi kolom &#39;Date&#39; menjadi tipe datetime </span>
<span class="n">df</span><span class="o">.</span><span class="n">set_index</span><span class="p">(</span><span class="s1">&#39;Date&#39;</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>  <span class="c1"># Menjadikan kolom &#39;Date&#39; sebagai indeks DataFrame</span>
<span class="n">m_past</span> <span class="o">=</span> <span class="mi">3</span>  <span class="c1"># Menetapkan jumlah sliding windows</span>
<span class="n">sliding_windows</span> <span class="o">=</span> <span class="p">[]</span>  
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">df</span><span class="p">)</span> <span class="o">-</span> <span class="n">m_past</span><span class="p">):</span>  <span class="c1">#pemrosesan menjadi sliding windows</span>
    <span class="n">window</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;minggu&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">i</span><span class="p">:</span><span class="n">i</span> <span class="o">+</span> <span class="n">m_past</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">values</span> 
    <span class="n">Date</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">index</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="n">m_past</span><span class="p">]</span>  
    <span class="n">sliding_windows</span><span class="o">.</span><span class="n">append</span><span class="p">([</span><span class="n">Date</span><span class="p">]</span> <span class="o">+</span> <span class="n">window</span><span class="o">.</span><span class="n">tolist</span><span class="p">())</span>  
<span class="n">sliding_windows_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">sliding_windows</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;Date&#39;</span><span class="p">]</span> <span class="o">+</span> <span class="p">[</span><span class="sa">f</span><span class="s1">&#39;minggu-</span><span class="si">{</span><span class="n">j</span><span class="si">}</span><span class="s1">&#39;</span> <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">m_past</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">)]</span> <span class="o">+</span> <span class="p">[</span><span class="s1">&#39;minggu&#39;</span><span class="p">])</span>
<span class="c1"># Menyimpan DataFrame hasil sliding window ke file CSV</span>
<span class="n">sliding_windows_df</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="s1">&#39;sliding_windows.csv&#39;</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">sliding_windows_df</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>          Date  minggu-3  minggu-2  minggu-1   minggu
0   2020-11-04   11900.0   12050.0   11900.0  12050.0
1   2020-11-11   12050.0   11900.0   12050.0  11900.0
2   2020-11-18   11900.0   12050.0   11900.0  12050.0
3   2020-11-25   12050.0   11900.0   12050.0  12050.0
4   2020-12-02   11900.0   12050.0   12050.0  12400.0
..         ...       ...       ...       ...      ...
201 2024-09-11   16750.0   16750.0   16750.0  16750.0
202 2024-09-18   16750.0   16750.0   16750.0  16750.0
203 2024-09-25   16750.0   16750.0   16750.0  16750.0
204 2024-10-02   16750.0   16750.0   16750.0  16750.0
205 2024-10-09   16750.0   16750.0   16750.0  16750.0

[206 rows x 5 columns]
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">from</span> <span class="nn">sklearn.model_selection</span> <span class="kn">import</span> <span class="n">train_test_split</span>
<span class="kn">from</span> <span class="nn">sklearn.preprocessing</span> <span class="kn">import</span> <span class="n">MinMaxScaler</span>

<span class="c1"># Baca file CSV</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;sliding_windows.csv&#39;</span><span class="p">)</span>

<span class="c1"># Pisahkan fitur dan target</span>
<span class="n">X</span> <span class="o">=</span> <span class="n">df</span><span class="p">[[</span><span class="s1">&#39;minggu-3&#39;</span><span class="p">,</span> <span class="s1">&#39;minggu-2&#39;</span><span class="p">,</span> <span class="s1">&#39;minggu-1&#39;</span><span class="p">]]</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;minggu&#39;</span><span class="p">]</span>

<span class="c1"># Bagi data menjadi data train dan test (80% train, 20% test)</span>
<span class="n">X_train</span><span class="p">,</span> <span class="n">X_test</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">y_test</span> <span class="o">=</span> <span class="n">train_test_split</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">test_size</span><span class="o">=</span><span class="mf">0.2</span><span class="p">,</span> <span class="n">shuffle</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

<span class="c1"># Inisialisasi scaler terpisah untuk X dan y, dan lakukan fitting hanya pada data train</span>
<span class="n">scaler_X</span> <span class="o">=</span> <span class="n">MinMaxScaler</span><span class="p">()</span>
<span class="n">scaler_y</span> <span class="o">=</span> <span class="n">MinMaxScaler</span><span class="p">()</span>

<span class="n">X_train_scaled</span> <span class="o">=</span> <span class="n">scaler_X</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">X_train</span><span class="p">)</span>
<span class="n">y_train_scaled</span> <span class="o">=</span> <span class="n">scaler_y</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">y_train</span><span class="o">.</span><span class="n">values</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span>

<span class="c1"># Normalisasi data test menggunakan parameter dari data train</span>
<span class="n">X_test_scaled</span> <span class="o">=</span> <span class="n">scaler_X</span><span class="o">.</span><span class="n">transform</span><span class="p">(</span><span class="n">X_test</span><span class="p">)</span>
<span class="n">y_test_scaled</span> <span class="o">=</span> <span class="n">scaler_y</span><span class="o">.</span><span class="n">transform</span><span class="p">(</span><span class="n">y_test</span><span class="o">.</span><span class="n">values</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span>

<span class="c1"># Konversi hasil normalisasi kembali ke DataFrame agar lebih mudah dibaca</span>
<span class="n">X_train_scaled</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">X_train_scaled</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="n">X</span><span class="o">.</span><span class="n">columns</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="n">X_train</span><span class="o">.</span><span class="n">index</span><span class="p">)</span>
<span class="n">X_test_scaled</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">X_test_scaled</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="n">X</span><span class="o">.</span><span class="n">columns</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="n">X_test</span><span class="o">.</span><span class="n">index</span><span class="p">)</span>
<span class="n">y_train_scaled</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="n">y_train_scaled</span><span class="o">.</span><span class="n">flatten</span><span class="p">(),</span> <span class="n">index</span><span class="o">=</span><span class="n">y_train</span><span class="o">.</span><span class="n">index</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;minggu&#39;</span><span class="p">)</span>
<span class="n">y_test_scaled</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="n">y_test_scaled</span><span class="o">.</span><span class="n">flatten</span><span class="p">(),</span> <span class="n">index</span><span class="o">=</span><span class="n">y_test</span><span class="o">.</span><span class="n">index</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;minggu&#39;</span><span class="p">)</span>

<span class="c1"># Gabungkan fitur dan target untuk train dan test</span>
<span class="n">train_data</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">X_train_scaled</span><span class="p">,</span> <span class="n">y_train_scaled</span><span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">test_data</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">X_test_scaled</span><span class="p">,</span> <span class="n">y_test_scaled</span><span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

<span class="c1"># Simpan data train dan test ke file CSV</span>
<span class="n">train_data</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="s1">&#39;train_data_normalized.csv&#39;</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">test_data</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="s1">&#39;test_data_normalized.csv&#39;</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Data train dan test yang sudah dinormalisasi telah disimpan ke file CSV.&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Data train dan test yang sudah dinormalisasi telah disimpan ke file CSV.
</pre></div>
</div>
</div>
</div>
</section>
<section id="modelling-dengan-regresi-linier">
<h2>MODELLING DENGAN REGRESI LINIER<a class="headerlink" href="#modelling-dengan-regresi-linier" title="Link to this heading">#</a></h2>
<p>Mean Absolute Percentage Error (MAPE):
Jika nilai MAPE kurang dari 10% maka kemampuan model peramalan sangat baik.
Jika nilai MAPE antara 10% - 20% maka kemampuan model peramalan baik.
Jika nilai MAPE kisaran 20% - 50% maka kemampuan model peramalan layak.
Root Mean Squared Error (RMSE):
semakin mendekati 0 semakin bagus</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">pickle</span>  <span class="c1"># Library untuk menyimpan model</span>
<span class="kn">from</span> <span class="nn">sklearn.linear_model</span> <span class="kn">import</span> <span class="n">LinearRegression</span>
<span class="kn">from</span> <span class="nn">sklearn.metrics</span> <span class="kn">import</span> <span class="n">mean_squared_error</span><span class="p">,</span> <span class="n">mean_absolute_percentage_error</span>
<span class="kn">from</span> <span class="nn">sklearn.preprocessing</span> <span class="kn">import</span> <span class="n">MinMaxScaler</span>

<span class="c1"># Baca file original untuk mendapatkan kolom Date dan nilai asli</span>
<span class="n">original_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;sliding_windows.csv&#39;</span><span class="p">)</span>
<span class="n">original_df</span><span class="p">[</span><span class="s1">&#39;Date&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">to_datetime</span><span class="p">(</span><span class="n">original_df</span><span class="p">[</span><span class="s1">&#39;Date&#39;</span><span class="p">])</span>

<span class="c1"># Baca data train dan test yang sudah dinormalisasi</span>
<span class="n">train_data</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;train_data_normalized.csv&#39;</span><span class="p">,</span> <span class="n">index_col</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="n">test_data</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;test_data_normalized.csv&#39;</span><span class="p">,</span> <span class="n">index_col</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>

<span class="c1"># Tambahkan kolom Date ke train_data dan test_data berdasarkan indeks mereka</span>
<span class="n">train_data</span><span class="p">[</span><span class="s1">&#39;Date&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">original_df</span><span class="p">[</span><span class="s1">&#39;Date&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:</span><span class="nb">len</span><span class="p">(</span><span class="n">train_data</span><span class="p">)]</span><span class="o">.</span><span class="n">values</span>
<span class="n">test_data</span><span class="p">[</span><span class="s1">&#39;Date&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">original_df</span><span class="p">[</span><span class="s1">&#39;Date&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="nb">len</span><span class="p">(</span><span class="n">train_data</span><span class="p">):]</span><span class="o">.</span><span class="n">values</span>

<span class="c1"># Pisahkan fitur dan target dari data train dan test</span>
<span class="n">X_train</span> <span class="o">=</span> <span class="n">train_data</span><span class="p">[[</span><span class="s1">&#39;minggu-1&#39;</span><span class="p">,</span> <span class="s1">&#39;minggu-2&#39;</span><span class="p">,</span> <span class="s1">&#39;minggu-3&#39;</span><span class="p">]]</span>
<span class="n">y_train</span> <span class="o">=</span> <span class="n">train_data</span><span class="p">[</span><span class="s1">&#39;minggu&#39;</span><span class="p">]</span>
<span class="n">X_test</span> <span class="o">=</span> <span class="n">test_data</span><span class="p">[[</span><span class="s1">&#39;minggu-1&#39;</span><span class="p">,</span> <span class="s1">&#39;minggu-2&#39;</span><span class="p">,</span> <span class="s1">&#39;minggu-3&#39;</span><span class="p">]]</span>
<span class="n">y_test</span> <span class="o">=</span> <span class="n">test_data</span><span class="p">[</span><span class="s1">&#39;minggu&#39;</span><span class="p">]</span>

<span class="c1"># Inisialisasi dan training model</span>
<span class="n">model</span> <span class="o">=</span> <span class="n">LinearRegression</span><span class="p">()</span>
<span class="n">model</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">)</span>


<span class="c1"># Prediksi dan evaluasi model pada data test</span>
<span class="n">y_pred</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_test</span><span class="p">)</span>
<span class="n">mse</span> <span class="o">=</span> <span class="n">mean_squared_error</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">y_pred</span><span class="p">)</span>
<span class="n">rmse</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">mse</span><span class="p">)</span>
<span class="n">mape</span> <span class="o">=</span> <span class="n">mean_absolute_percentage_error</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">y_pred</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Mean Squared Error (MSE):&quot;</span><span class="p">,</span> <span class="n">mse</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Root Mean Squared Error (RMSE):&quot;</span><span class="p">,</span> <span class="n">rmse</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Mean Absolute Percentage Error (MAPE):&quot;</span><span class="p">,</span> <span class="n">mape</span><span class="p">,</span> <span class="s2">&quot;%&quot;</span><span class="p">)</span>

<span class="c1"># Prediksi untuk minggu berikutnya menggunakan data terbaru dari data train</span>
<span class="n">last_data</span> <span class="o">=</span> <span class="n">train_data</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">][[</span><span class="s1">&#39;minggu-1&#39;</span><span class="p">,</span> <span class="s1">&#39;minggu-2&#39;</span><span class="p">,</span> <span class="s1">&#39;minggu-3&#39;</span><span class="p">]]</span><span class="o">.</span><span class="n">values</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span>
<span class="n">predicted_value</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">last_data</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Predicted value for next week (normalized scale):&quot;</span><span class="p">,</span> <span class="n">predicted_value</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>

<span class="c1"># Inisialisasi MinMaxScaler dan fit pada kolom &#39;minggu&#39; dari original_df untuk mendapatkan skala asli</span>
<span class="n">scaler</span> <span class="o">=</span> <span class="n">MinMaxScaler</span><span class="p">()</span>
<span class="n">scaler</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">original_df</span><span class="p">[[</span><span class="s1">&#39;minggu&#39;</span><span class="p">]])</span>

<span class="c1"># Balikkan prediksi ke skala asli</span>
<span class="n">predicted_value_original</span> <span class="o">=</span> <span class="n">scaler</span><span class="o">.</span><span class="n">inverse_transform</span><span class="p">([[</span><span class="n">predicted_value</span><span class="p">[</span><span class="mi">0</span><span class="p">]]])[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Predicted value for next week (original scale):&quot;</span><span class="p">,</span> <span class="n">predicted_value_original</span><span class="p">)</span>

<span class="c1"># Mendapatkan tanggal terakhir dari data train dan menambah satu minggu untuk prediksi</span>
<span class="n">predicted_date</span> <span class="o">=</span> <span class="n">train_data</span><span class="p">[</span><span class="s1">&#39;Date&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">pd</span><span class="o">.</span><span class="n">Timedelta</span><span class="p">(</span><span class="n">weeks</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">predicted_row</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span>
    <span class="s1">&#39;Date&#39;</span><span class="p">:</span> <span class="p">[</span><span class="n">predicted_date</span><span class="p">],</span>
    <span class="s1">&#39;minggu-1&#39;</span><span class="p">:</span> <span class="n">last_data</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span>
    <span class="s1">&#39;minggu-2&#39;</span><span class="p">:</span> <span class="n">last_data</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">],</span>
    <span class="s1">&#39;minggu-3&#39;</span><span class="p">:</span> <span class="n">last_data</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">2</span><span class="p">],</span>
    <span class="s1">&#39;minggu&#39;</span><span class="p">:</span> <span class="n">predicted_value</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="p">})</span>

<span class="c1"># Menambahkan baris prediksi ke DataFrame yang dinormalisasi</span>
<span class="n">normalized_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">train_data</span><span class="p">,</span> <span class="n">predicted_row</span><span class="p">],</span> <span class="n">ignore_index</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="c1"># Visualisasi</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">normalized_df</span><span class="p">[</span><span class="s1">&#39;Date&#39;</span><span class="p">],</span> <span class="n">normalized_df</span><span class="p">[</span><span class="s1">&#39;minggu&#39;</span><span class="p">],</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Actual (normalized)&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;blue&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">predicted_row</span><span class="p">[</span><span class="s1">&#39;Date&#39;</span><span class="p">],</span> <span class="n">predicted_row</span><span class="p">[</span><span class="s1">&#39;minggu&#39;</span><span class="p">],</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Prediksi minggu depan (normalized)&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;green&#39;</span><span class="p">,</span> <span class="n">s</span><span class="o">=</span><span class="mi">100</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Data Aktual vs Data Prediksi (Skala Normalisasi)&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Date&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Normalized Values&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xticks</span><span class="p">(</span><span class="n">rotation</span><span class="o">=</span><span class="mi">45</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

<span class="c1"># Informasi tambahan tentang nilai asli prediksi minggu depan</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Prediksi nilai minggu depan (harga asli): </span><span class="si">{</span><span class="n">predicted_value_original</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Mean Squared Error (MSE): 8.789001620056902e-05
Root Mean Squared Error (RMSE): 0.009374967530640788
Mean Absolute Percentage Error (MAPE): 0.010305613091575502 %
Predicted value for next week (normalized scale): 0.6924134430356987
Predicted value for next week (original scale): 16469.92872403561
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>c:\Users\men\AppData\Local\Programs\Python\Python312\Lib\site-packages\sklearn\base.py:493: UserWarning: X does not have valid feature names, but LinearRegression was fitted with feature names
  warnings.warn(
</pre></div>
</div>
<img alt="_images/b738198d9362d531085d1bc0789a2c2c5892aac562008b29f861d778c8455a37.png" src="_images/b738198d9362d531085d1bc0789a2c2c5892aac562008b29f861d778c8455a37.png" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Prediksi nilai minggu depan (harga asli): 16469.92872403561
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">pickle</span>
<span class="kn">from</span> <span class="nn">sklearn.linear_model</span> <span class="kn">import</span> <span class="n">LinearRegression</span>
<span class="kn">from</span> <span class="nn">sklearn.preprocessing</span> <span class="kn">import</span> <span class="n">MinMaxScaler</span>

<span class="c1"># Baca data asli</span>
<span class="n">original_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;sliding_windows.csv&#39;</span><span class="p">)</span>
<span class="n">original_df</span><span class="p">[</span><span class="s1">&#39;Date&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">to_datetime</span><span class="p">(</span><span class="n">original_df</span><span class="p">[</span><span class="s1">&#39;Date&#39;</span><span class="p">])</span>

<span class="c1"># Siapkan fitur dan target</span>
<span class="n">features</span> <span class="o">=</span> <span class="n">original_df</span><span class="p">[[</span><span class="s1">&#39;minggu-1&#39;</span><span class="p">,</span> <span class="s1">&#39;minggu-2&#39;</span><span class="p">,</span> <span class="s1">&#39;minggu-3&#39;</span><span class="p">]]</span>
<span class="n">target</span> <span class="o">=</span> <span class="n">original_df</span><span class="p">[</span><span class="s1">&#39;minggu&#39;</span><span class="p">]</span>  <span class="c1"># Target kolom</span>

<span class="c1"># Inisialisasi scaler pada fitur saja dan fit scaler</span>
<span class="n">scaler</span> <span class="o">=</span> <span class="n">MinMaxScaler</span><span class="p">()</span>
<span class="n">normalized_features</span> <span class="o">=</span> <span class="n">scaler</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">features</span><span class="p">)</span>

<span class="c1"># Pisahkan data ke dalam train dan test</span>
<span class="n">train_size</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="mf">0.8</span> <span class="o">*</span> <span class="nb">len</span><span class="p">(</span><span class="n">features</span><span class="p">))</span>
<span class="n">X_train</span> <span class="o">=</span> <span class="n">normalized_features</span><span class="p">[:</span><span class="n">train_size</span><span class="p">]</span>  <span class="c1"># Fitur yang sudah dinormalisasi</span>
<span class="n">X_test</span> <span class="o">=</span> <span class="n">normalized_features</span><span class="p">[</span><span class="n">train_size</span><span class="p">:]</span>
<span class="n">y_train</span> <span class="o">=</span> <span class="n">target</span><span class="p">[:</span><span class="n">train_size</span><span class="p">]</span><span class="o">.</span><span class="n">values</span>  <span class="c1"># Target tanpa normalisasi</span>
<span class="n">y_test</span> <span class="o">=</span> <span class="n">target</span><span class="p">[</span><span class="n">train_size</span><span class="p">:]</span><span class="o">.</span><span class="n">values</span>

<span class="c1"># Inisialisasi dan training model</span>
<span class="n">model</span> <span class="o">=</span> <span class="n">LinearRegression</span><span class="p">()</span>
<span class="n">model</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">)</span>

<span class="c1"># Simpan model dan scaler ke dalam file .pkl</span>
<span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="s1">&#39;linear_regression_model.pkl&#39;</span><span class="p">,</span> <span class="s1">&#39;wb&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">file</span><span class="p">:</span>
    <span class="n">pickle</span><span class="o">.</span><span class="n">dump</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">file</span><span class="p">)</span>
<span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="s1">&#39;scaler.pkl&#39;</span><span class="p">,</span> <span class="s1">&#39;wb&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">file</span><span class="p">:</span>
    <span class="n">pickle</span><span class="o">.</span><span class="n">dump</span><span class="p">(</span><span class="n">scaler</span><span class="p">,</span> <span class="n">file</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Model dan scaler berhasil disimpan.&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Model dan scaler berhasil disimpan.
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">pickle</span>

<span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="s1">&#39;linear_regression_model.pkl&#39;</span><span class="p">,</span> <span class="s1">&#39;rb&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">file</span><span class="p">:</span>
    <span class="n">loaded_model</span> <span class="o">=</span> <span class="n">pickle</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">file</span><span class="p">)</span>
<span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="s1">&#39;scaler.pkl&#39;</span><span class="p">,</span> <span class="s1">&#39;rb&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">file</span><span class="p">:</span>
    <span class="n">loaded_scaler</span> <span class="o">=</span> <span class="n">pickle</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">file</span><span class="p">)</span>

<span class="n">new_data</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">10000</span><span class="p">,</span><span class="mi">10500</span><span class="p">,</span><span class="mi">11000</span><span class="p">]])</span> 

<span class="n">normalized_new_data</span> <span class="o">=</span> <span class="n">loaded_scaler</span><span class="o">.</span><span class="n">transform</span><span class="p">(</span><span class="n">new_data</span><span class="p">)</span>


<span class="n">prediction</span> <span class="o">=</span> <span class="n">loaded_model</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">normalized_new_data</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Prediction for the new data: </span><span class="si">{</span><span class="n">prediction</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Prediction for the new data: [10346.88863191]
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>c:\Users\men\AppData\Local\Programs\Python\Python312\Lib\site-packages\sklearn\base.py:493: UserWarning: X does not have valid feature names, but MinMaxScaler was fitted with feature names
  warnings.warn(
</pre></div>
</div>
</div>
</div>
</section>
<section id="mencoba-menggunakan-model-lain-lstm">
<h2>mencoba menggunakan model lain(LSTM)<a class="headerlink" href="#mencoba-menggunakan-model-lain-lstm" title="Link to this heading">#</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">from</span> <span class="nn">sklearn.metrics</span> <span class="kn">import</span> <span class="n">mean_squared_error</span><span class="p">,</span> <span class="n">mean_absolute_percentage_error</span>
<span class="kn">from</span> <span class="nn">tensorflow.keras.models</span> <span class="kn">import</span> <span class="n">Sequential</span>
<span class="kn">from</span> <span class="nn">tensorflow.keras.layers</span> <span class="kn">import</span> <span class="n">LSTM</span><span class="p">,</span> <span class="n">Dense</span>
<span class="kn">from</span> <span class="nn">sklearn.preprocessing</span> <span class="kn">import</span> <span class="n">MinMaxScaler</span>

<span class="c1"># Baca file original untuk mendapatkan kolom Date dan nilai asli</span>
<span class="n">original_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;sliding_windows.csv&#39;</span><span class="p">)</span>
<span class="n">original_df</span><span class="p">[</span><span class="s1">&#39;Date&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">to_datetime</span><span class="p">(</span><span class="n">original_df</span><span class="p">[</span><span class="s1">&#39;Date&#39;</span><span class="p">])</span>

<span class="c1"># Baca data train dan test yang sudah dinormalisasi</span>
<span class="n">train_data</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;train_data_normalized.csv&#39;</span><span class="p">,</span> <span class="n">index_col</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="n">test_data</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;test_data_normalized.csv&#39;</span><span class="p">,</span> <span class="n">index_col</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>

<span class="c1"># Tambahkan kolom Date ke train_data dan test_data berdasarkan indeks mereka dari original_df</span>
<span class="n">train_data</span><span class="p">[</span><span class="s1">&#39;Date&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">original_df</span><span class="p">[</span><span class="s1">&#39;Date&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:</span><span class="nb">len</span><span class="p">(</span><span class="n">train_data</span><span class="p">)]</span><span class="o">.</span><span class="n">values</span>
<span class="n">test_data</span><span class="p">[</span><span class="s1">&#39;Date&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">original_df</span><span class="p">[</span><span class="s1">&#39;Date&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="nb">len</span><span class="p">(</span><span class="n">train_data</span><span class="p">):</span><span class="nb">len</span><span class="p">(</span><span class="n">train_data</span><span class="p">)</span> <span class="o">+</span> <span class="nb">len</span><span class="p">(</span><span class="n">test_data</span><span class="p">)]</span><span class="o">.</span><span class="n">values</span>

<span class="c1"># Pisahkan fitur dan target dari data train dan test</span>
<span class="n">X_train</span> <span class="o">=</span> <span class="n">train_data</span><span class="p">[[</span><span class="s1">&#39;minggu-1&#39;</span><span class="p">,</span> <span class="s1">&#39;minggu-2&#39;</span><span class="p">,</span> <span class="s1">&#39;minggu-3&#39;</span><span class="p">]]</span><span class="o">.</span><span class="n">values</span>
<span class="n">y_train</span> <span class="o">=</span> <span class="n">train_data</span><span class="p">[</span><span class="s1">&#39;minggu&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span>
<span class="n">X_test</span> <span class="o">=</span> <span class="n">test_data</span><span class="p">[[</span><span class="s1">&#39;minggu-1&#39;</span><span class="p">,</span> <span class="s1">&#39;minggu-2&#39;</span><span class="p">,</span> <span class="s1">&#39;minggu-3&#39;</span><span class="p">]]</span><span class="o">.</span><span class="n">values</span>
<span class="n">y_test</span> <span class="o">=</span> <span class="n">test_data</span><span class="p">[</span><span class="s1">&#39;minggu&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span>

<span class="c1"># Reshape input untuk [samples, time steps, features] agar sesuai dengan input LSTM</span>
<span class="n">X_train</span> <span class="o">=</span> <span class="n">X_train</span><span class="o">.</span><span class="n">reshape</span><span class="p">((</span><span class="n">X_train</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="mi">1</span><span class="p">,</span> <span class="n">X_train</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]))</span>
<span class="n">X_test</span> <span class="o">=</span> <span class="n">X_test</span><span class="o">.</span><span class="n">reshape</span><span class="p">((</span><span class="n">X_test</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="mi">1</span><span class="p">,</span> <span class="n">X_test</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]))</span>

<span class="c1"># Definisikan model LSTM</span>
<span class="n">model</span> <span class="o">=</span> <span class="n">Sequential</span><span class="p">()</span>
<span class="n">model</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">LSTM</span><span class="p">(</span><span class="mi">50</span><span class="p">,</span> <span class="n">activation</span><span class="o">=</span><span class="s1">&#39;relu&#39;</span><span class="p">,</span> <span class="n">input_shape</span><span class="o">=</span><span class="p">(</span><span class="n">X_train</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">X_train</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">2</span><span class="p">])))</span>
<span class="n">model</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">Dense</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span>
<span class="n">model</span><span class="o">.</span><span class="n">compile</span><span class="p">(</span><span class="n">optimizer</span><span class="o">=</span><span class="s1">&#39;adam&#39;</span><span class="p">,</span> <span class="n">loss</span><span class="o">=</span><span class="s1">&#39;mse&#39;</span><span class="p">)</span>

<span class="c1"># Training model</span>
<span class="n">history</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">epochs</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span> <span class="n">batch_size</span><span class="o">=</span><span class="mi">32</span><span class="p">,</span> <span class="n">validation_data</span><span class="o">=</span><span class="p">(</span><span class="n">X_test</span><span class="p">,</span> <span class="n">y_test</span><span class="p">),</span> <span class="n">verbose</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

<span class="c1"># Prediksi dan evaluasi pada data test</span>
<span class="n">y_pred</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_test</span><span class="p">)</span>
<span class="n">mse</span> <span class="o">=</span> <span class="n">mean_squared_error</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">y_pred</span><span class="p">)</span>
<span class="n">rmse</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">mse</span><span class="p">)</span>
<span class="n">mape</span> <span class="o">=</span> <span class="n">mean_absolute_percentage_error</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">y_pred</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Mean Squared Error (MSE):&quot;</span><span class="p">,</span> <span class="n">mse</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Root Mean Squared Error (RMSE):&quot;</span><span class="p">,</span> <span class="n">rmse</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Mean Absolute Percentage Error (MAPE):&quot;</span><span class="p">,</span> <span class="n">mape</span><span class="p">,</span> <span class="s2">&quot;%&quot;</span><span class="p">)</span>

<span class="c1"># Prediksi nilai minggu depan menggunakan data terakhir dari data train</span>
<span class="n">last_data</span> <span class="o">=</span> <span class="n">train_data</span><span class="p">[[</span><span class="s1">&#39;minggu-1&#39;</span><span class="p">,</span> <span class="s1">&#39;minggu-2&#39;</span><span class="p">,</span> <span class="s1">&#39;minggu-3&#39;</span><span class="p">]]</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span>
<span class="n">predicted_value</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">last_data</span><span class="p">)</span>

<span class="c1"># Inisialisasi MinMaxScaler dengan data asli untuk mengembalikan prediksi ke skala asli</span>
<span class="n">scaler</span> <span class="o">=</span> <span class="n">MinMaxScaler</span><span class="p">()</span>
<span class="n">scaler</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">original_df</span><span class="p">[[</span><span class="s1">&#39;minggu&#39;</span><span class="p">]])</span>

<span class="c1"># Balikkan prediksi ke harga asli</span>
<span class="n">combined_data</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">((</span><span class="n">last_data</span><span class="o">.</span><span class="n">flatten</span><span class="p">()</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">),</span> <span class="n">predicted_value</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)),</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">predicted_value_original</span> <span class="o">=</span> <span class="n">scaler</span><span class="o">.</span><span class="n">inverse_transform</span><span class="p">(</span><span class="n">combined_data</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Predicted value for next week (original scale):&quot;</span><span class="p">,</span> <span class="n">predicted_value_original</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>

<span class="c1"># Tambahkan prediksi minggu depan ke DataFrame untuk visualisasi</span>
<span class="n">predicted_date</span> <span class="o">=</span> <span class="n">train_data</span><span class="p">[</span><span class="s1">&#39;Date&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">pd</span><span class="o">.</span><span class="n">Timedelta</span><span class="p">(</span><span class="n">weeks</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">predicted_row</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span>
    <span class="s1">&#39;Date&#39;</span><span class="p">:</span> <span class="p">[</span><span class="n">predicted_date</span><span class="p">],</span>
    <span class="s1">&#39;minggu-1&#39;</span><span class="p">:</span> <span class="p">[</span><span class="n">last_data</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]],</span>
    <span class="s1">&#39;minggu-2&#39;</span><span class="p">:</span> <span class="p">[</span><span class="n">last_data</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">]],</span>
    <span class="s1">&#39;minggu-3&#39;</span><span class="p">:</span> <span class="p">[</span><span class="n">last_data</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">][</span><span class="mi">2</span><span class="p">]],</span>
    <span class="s1">&#39;minggu&#39;</span><span class="p">:</span> <span class="n">predicted_value</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
<span class="p">})</span>
<span class="n">train_data</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">train_data</span><span class="p">,</span> <span class="n">predicted_row</span><span class="p">],</span> <span class="n">ignore_index</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="c1"># Visualisasi hasil prediksi</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">train_data</span><span class="p">[</span><span class="s1">&#39;Date&#39;</span><span class="p">],</span> <span class="n">train_data</span><span class="p">[</span><span class="s1">&#39;minggu&#39;</span><span class="p">],</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Actual&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;blue&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">predicted_row</span><span class="p">[</span><span class="s1">&#39;Date&#39;</span><span class="p">],</span> <span class="n">predicted_row</span><span class="p">[</span><span class="s1">&#39;minggu&#39;</span><span class="p">],</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Predicted Next Week&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">,</span> <span class="n">s</span><span class="o">=</span><span class="mi">100</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Actual vs Predicted Values with Next Week Prediction&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Date&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Normalized Values&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xticks</span><span class="p">(</span><span class="n">rotation</span><span class="o">=</span><span class="mi">45</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Epoch 1/100
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>c:\Users\men\AppData\Local\Programs\Python\Python312\Lib\site-packages\keras\src\layers\rnn\rnn.py:204: UserWarning: Do not pass an `input_shape`/`input_dim` argument to a layer. When using Sequential models, prefer using an `Input(shape)` object as the first layer in the model instead.
  super().__init__(**kwargs)
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span><span class=" -Color -Color-Bold">6/6</span> <span class=" -Color -Color-Green"></span> <span class=" -Color -Color-Bold">3s</span> 85ms/step - loss: 0.4472 - val_loss: 0.5665
Epoch 2/100
<span class=" -Color -Color-Bold">6/6</span> <span class=" -Color -Color-Green"></span> <span class=" -Color -Color-Bold">0s</span> 12ms/step - loss: 0.3913 - val_loss: 0.5335
Epoch 3/100
<span class=" -Color -Color-Bold">6/6</span> <span class=" -Color -Color-Green"></span> <span class=" -Color -Color-Bold">0s</span> 13ms/step - loss: 0.3597 - val_loss: 0.5019
Epoch 4/100
<span class=" -Color -Color-Bold">6/6</span> <span class=" -Color -Color-Green"></span> <span class=" -Color -Color-Bold">0s</span> 13ms/step - loss: 0.3559 - val_loss: 0.4685
Epoch 5/100
<span class=" -Color -Color-Bold">6/6</span> <span class=" -Color -Color-Green"></span> <span class=" -Color -Color-Bold">0s</span> 11ms/step - loss: 0.3282 - val_loss: 0.4345
Epoch 6/100
<span class=" -Color -Color-Bold">6/6</span> <span class=" -Color -Color-Green"></span> <span class=" -Color -Color-Bold">0s</span> 14ms/step - loss: 0.3031 - val_loss: 0.4001
Epoch 7/100
<span class=" -Color -Color-Bold">6/6</span> <span class=" -Color -Color-Green"></span> <span class=" -Color -Color-Bold">0s</span> 12ms/step - loss: 0.2910 - val_loss: 0.3667
Epoch 8/100
<span class=" -Color -Color-Bold">6/6</span> <span class=" -Color -Color-Green"></span> <span class=" -Color -Color-Bold">0s</span> 12ms/step - loss: 0.2368 - val_loss: 0.3328
Epoch 9/100
<span class=" -Color -Color-Bold">6/6</span> <span class=" -Color -Color-Green"></span> <span class=" -Color -Color-Bold">0s</span> 12ms/step - loss: 0.2395 - val_loss: 0.2979
Epoch 10/100
<span class=" -Color -Color-Bold">6/6</span> <span class=" -Color -Color-Green"></span> <span class=" -Color -Color-Bold">0s</span> 14ms/step - loss: 0.2021 - val_loss: 0.2626
Epoch 11/100
<span class=" -Color -Color-Bold">6/6</span> <span class=" -Color -Color-Green"></span> <span class=" -Color -Color-Bold">0s</span> 12ms/step - loss: 0.1792 - val_loss: 0.2270
Epoch 12/100
<span class=" -Color -Color-Bold">6/6</span> <span class=" -Color -Color-Green"></span> <span class=" -Color -Color-Bold">0s</span> 15ms/step - loss: 0.1544 - val_loss: 0.1922
Epoch 13/100
<span class=" -Color -Color-Bold">6/6</span> <span class=" -Color -Color-Green"></span> <span class=" -Color -Color-Bold">0s</span> 12ms/step - loss: 0.1333 - val_loss: 0.1579
Epoch 14/100
<span class=" -Color -Color-Bold">6/6</span> <span class=" -Color -Color-Green"></span> <span class=" -Color -Color-Bold">0s</span> 12ms/step - loss: 0.1079 - val_loss: 0.1252
Epoch 15/100
<span class=" -Color -Color-Bold">6/6</span> <span class=" -Color -Color-Green"></span> <span class=" -Color -Color-Bold">0s</span> 13ms/step - loss: 0.0836 - val_loss: 0.0956
Epoch 16/100
<span class=" -Color -Color-Bold">6/6</span> <span class=" -Color -Color-Green"></span> <span class=" -Color -Color-Bold">0s</span> 12ms/step - loss: 0.0696 - val_loss: 0.0692
Epoch 17/100
<span class=" -Color -Color-Bold">6/6</span> <span class=" -Color -Color-Green"></span> <span class=" -Color -Color-Bold">0s</span> 12ms/step - loss: 0.0534 - val_loss: 0.0466
Epoch 18/100
<span class=" -Color -Color-Bold">6/6</span> <span class=" -Color -Color-Green"></span> <span class=" -Color -Color-Bold">0s</span> 14ms/step - loss: 0.0371 - val_loss: 0.0297
Epoch 19/100
<span class=" -Color -Color-Bold">6/6</span> <span class=" -Color -Color-Green"></span> <span class=" -Color -Color-Bold">0s</span> 12ms/step - loss: 0.0291 - val_loss: 0.0175
Epoch 20/100
<span class=" -Color -Color-Bold">6/6</span> <span class=" -Color -Color-Green"></span> <span class=" -Color -Color-Bold">0s</span> 11ms/step - loss: 0.0244 - val_loss: 0.0092
Epoch 21/100
<span class=" -Color -Color-Bold">6/6</span> <span class=" -Color -Color-Green"></span> <span class=" -Color -Color-Bold">0s</span> 12ms/step - loss: 0.0206 - val_loss: 0.0042
Epoch 22/100
<span class=" -Color -Color-Bold">6/6</span> <span class=" -Color -Color-Green"></span> <span class=" -Color -Color-Bold">0s</span> 12ms/step - loss: 0.0208 - val_loss: 0.0018
Epoch 23/100
<span class=" -Color -Color-Bold">6/6</span> <span class=" -Color -Color-Green"></span> <span class=" -Color -Color-Bold">0s</span> 13ms/step - loss: 0.0149 - val_loss: 7.1897e-04
Epoch 24/100
<span class=" -Color -Color-Bold">6/6</span> <span class=" -Color -Color-Green"></span> <span class=" -Color -Color-Bold">0s</span> 15ms/step - loss: 0.0167 - val_loss: 3.6018e-04
Epoch 25/100
<span class=" -Color -Color-Bold">6/6</span> <span class=" -Color -Color-Green"></span> <span class=" -Color -Color-Bold">0s</span> 13ms/step - loss: 0.0178 - val_loss: 2.2688e-04
Epoch 26/100
<span class=" -Color -Color-Bold">6/6</span> <span class=" -Color -Color-Green"></span> <span class=" -Color -Color-Bold">0s</span> 12ms/step - loss: 0.0165 - val_loss: 2.4989e-04
Epoch 27/100
<span class=" -Color -Color-Bold">6/6</span> <span class=" -Color -Color-Green"></span> <span class=" -Color -Color-Bold">0s</span> 12ms/step - loss: 0.0220 - val_loss: 4.3741e-04
Epoch 28/100
<span class=" -Color -Color-Bold">6/6</span> <span class=" -Color -Color-Green"></span> <span class=" -Color -Color-Bold">0s</span> 12ms/step - loss: 0.0219 - val_loss: 6.2015e-04
Epoch 29/100
<span class=" -Color -Color-Bold">6/6</span> <span class=" -Color -Color-Green"></span> <span class=" -Color -Color-Bold">0s</span> 12ms/step - loss: 0.0134 - val_loss: 7.5445e-04
Epoch 30/100
<span class=" -Color -Color-Bold">6/6</span> <span class=" -Color -Color-Green"></span> <span class=" -Color -Color-Bold">0s</span> 12ms/step - loss: 0.0157 - val_loss: 0.0011
Epoch 31/100
<span class=" -Color -Color-Bold">6/6</span> <span class=" -Color -Color-Green"></span> <span class=" -Color -Color-Bold">0s</span> 13ms/step - loss: 0.0131 - val_loss: 0.0011
Epoch 32/100
<span class=" -Color -Color-Bold">6/6</span> <span class=" -Color -Color-Green"></span> <span class=" -Color -Color-Bold">0s</span> 12ms/step - loss: 0.0192 - val_loss: 0.0011
Epoch 33/100
<span class=" -Color -Color-Bold">6/6</span> <span class=" -Color -Color-Green"></span> <span class=" -Color -Color-Bold">0s</span> 11ms/step - loss: 0.0134 - val_loss: 0.0010
Epoch 34/100
<span class=" -Color -Color-Bold">6/6</span> <span class=" -Color -Color-Green"></span> <span class=" -Color -Color-Bold">0s</span> 12ms/step - loss: 0.0126 - val_loss: 0.0011
Epoch 35/100
<span class=" -Color -Color-Bold">6/6</span> <span class=" -Color -Color-Green"></span> <span class=" -Color -Color-Bold">0s</span> 12ms/step - loss: 0.0214 - val_loss: 0.0017
Epoch 36/100
<span class=" -Color -Color-Bold">6/6</span> <span class=" -Color -Color-Green"></span> <span class=" -Color -Color-Bold">0s</span> 12ms/step - loss: 0.0129 - val_loss: 0.0018
Epoch 37/100
<span class=" -Color -Color-Bold">6/6</span> <span class=" -Color -Color-Green"></span> <span class=" -Color -Color-Bold">0s</span> 11ms/step - loss: 0.0134 - val_loss: 0.0016
Epoch 38/100
<span class=" -Color -Color-Bold">6/6</span> <span class=" -Color -Color-Green"></span> <span class=" -Color -Color-Bold">0s</span> 12ms/step - loss: 0.0162 - val_loss: 0.0013
Epoch 39/100
<span class=" -Color -Color-Bold">6/6</span> <span class=" -Color -Color-Green"></span> <span class=" -Color -Color-Bold">0s</span> 12ms/step - loss: 0.0161 - val_loss: 0.0011
Epoch 40/100
<span class=" -Color -Color-Bold">6/6</span> <span class=" -Color -Color-Green"></span> <span class=" -Color -Color-Bold">0s</span> 12ms/step - loss: 0.0134 - val_loss: 9.4410e-04
Epoch 41/100
<span class=" -Color -Color-Bold">6/6</span> <span class=" -Color -Color-Green"></span> <span class=" -Color -Color-Bold">0s</span> 13ms/step - loss: 0.0112 - val_loss: 0.0012
Epoch 42/100
<span class=" -Color -Color-Bold">6/6</span> <span class=" -Color -Color-Green"></span> <span class=" -Color -Color-Bold">0s</span> 13ms/step - loss: 0.0163 - val_loss: 0.0012
Epoch 43/100
<span class=" -Color -Color-Bold">6/6</span> <span class=" -Color -Color-Green"></span> <span class=" -Color -Color-Bold">0s</span> 13ms/step - loss: 0.0195 - val_loss: 0.0011
Epoch 44/100
<span class=" -Color -Color-Bold">6/6</span> <span class=" -Color -Color-Green"></span> <span class=" -Color -Color-Bold">0s</span> 10ms/step - loss: 0.0134 - val_loss: 8.8423e-04
Epoch 45/100
<span class=" -Color -Color-Bold">6/6</span> <span class=" -Color -Color-Green"></span> <span class=" -Color -Color-Bold">0s</span> 13ms/step - loss: 0.0119 - val_loss: 6.9708e-04
Epoch 46/100
<span class=" -Color -Color-Bold">6/6</span> <span class=" -Color -Color-Green"></span> <span class=" -Color -Color-Bold">0s</span> 13ms/step - loss: 0.0109 - val_loss: 7.9241e-04
Epoch 47/100
<span class=" -Color -Color-Bold">6/6</span> <span class=" -Color -Color-Green"></span> <span class=" -Color -Color-Bold">0s</span> 11ms/step - loss: 0.0142 - val_loss: 6.0926e-04
Epoch 48/100
<span class=" -Color -Color-Bold">6/6</span> <span class=" -Color -Color-Green"></span> <span class=" -Color -Color-Bold">0s</span> 13ms/step - loss: 0.0138 - val_loss: 5.5514e-04
Epoch 49/100
<span class=" -Color -Color-Bold">6/6</span> <span class=" -Color -Color-Green"></span> <span class=" -Color -Color-Bold">0s</span> 14ms/step - loss: 0.0122 - val_loss: 6.2993e-04
Epoch 50/100
<span class=" -Color -Color-Bold">6/6</span> <span class=" -Color -Color-Green"></span> <span class=" -Color -Color-Bold">0s</span> 11ms/step - loss: 0.0142 - val_loss: 5.6718e-04
Epoch 51/100
<span class=" -Color -Color-Bold">6/6</span> <span class=" -Color -Color-Green"></span> <span class=" -Color -Color-Bold">0s</span> 11ms/step - loss: 0.0144 - val_loss: 5.4566e-04
Epoch 52/100
<span class=" -Color -Color-Bold">6/6</span> <span class=" -Color -Color-Green"></span> <span class=" -Color -Color-Bold">0s</span> 14ms/step - loss: 0.0147 - val_loss: 5.0585e-04
Epoch 53/100
<span class=" -Color -Color-Bold">6/6</span> <span class=" -Color -Color-Green"></span> <span class=" -Color -Color-Bold">0s</span> 12ms/step - loss: 0.0109 - val_loss: 4.7657e-04
Epoch 54/100
<span class=" -Color -Color-Bold">6/6</span> <span class=" -Color -Color-Green"></span> <span class=" -Color -Color-Bold">0s</span> 12ms/step - loss: 0.0123 - val_loss: 4.8634e-04
Epoch 55/100
<span class=" -Color -Color-Bold">6/6</span> <span class=" -Color -Color-Green"></span> <span class=" -Color -Color-Bold">0s</span> 11ms/step - loss: 0.0108 - val_loss: 5.1091e-04
Epoch 56/100
<span class=" -Color -Color-Bold">6/6</span> <span class=" -Color -Color-Green"></span> <span class=" -Color -Color-Bold">0s</span> 12ms/step - loss: 0.0122 - val_loss: 4.6007e-04
Epoch 57/100
<span class=" -Color -Color-Bold">6/6</span> <span class=" -Color -Color-Green"></span> <span class=" -Color -Color-Bold">0s</span> 13ms/step - loss: 0.0129 - val_loss: 4.1115e-04
Epoch 58/100
<span class=" -Color -Color-Bold">6/6</span> <span class=" -Color -Color-Green"></span> <span class=" -Color -Color-Bold">0s</span> 13ms/step - loss: 0.0150 - val_loss: 5.1066e-04
Epoch 59/100
<span class=" -Color -Color-Bold">6/6</span> <span class=" -Color -Color-Green"></span> <span class=" -Color -Color-Bold">0s</span> 12ms/step - loss: 0.0140 - val_loss: 6.2765e-04
Epoch 60/100
<span class=" -Color -Color-Bold">6/6</span> <span class=" -Color -Color-Green"></span> <span class=" -Color -Color-Bold">0s</span> 12ms/step - loss: 0.0110 - val_loss: 5.7030e-04
Epoch 61/100
<span class=" -Color -Color-Bold">6/6</span> <span class=" -Color -Color-Green"></span> <span class=" -Color -Color-Bold">0s</span> 11ms/step - loss: 0.0121 - val_loss: 5.3514e-04
Epoch 62/100
<span class=" -Color -Color-Bold">6/6</span> <span class=" -Color -Color-Green"></span> <span class=" -Color -Color-Bold">0s</span> 12ms/step - loss: 0.0123 - val_loss: 5.0460e-04
Epoch 63/100
<span class=" -Color -Color-Bold">6/6</span> <span class=" -Color -Color-Green"></span> <span class=" -Color -Color-Bold">0s</span> 12ms/step - loss: 0.0160 - val_loss: 3.2037e-04
Epoch 64/100
<span class=" -Color -Color-Bold">6/6</span> <span class=" -Color -Color-Green"></span> <span class=" -Color -Color-Bold">0s</span> 13ms/step - loss: 0.0128 - val_loss: 2.5957e-04
Epoch 65/100
<span class=" -Color -Color-Bold">6/6</span> <span class=" -Color -Color-Green"></span> <span class=" -Color -Color-Bold">0s</span> 12ms/step - loss: 0.0116 - val_loss: 3.1839e-04
Epoch 66/100
<span class=" -Color -Color-Bold">6/6</span> <span class=" -Color -Color-Green"></span> <span class=" -Color -Color-Bold">0s</span> 11ms/step - loss: 0.0125 - val_loss: 4.0625e-04
Epoch 67/100
<span class=" -Color -Color-Bold">6/6</span> <span class=" -Color -Color-Green"></span> <span class=" -Color -Color-Bold">0s</span> 11ms/step - loss: 0.0143 - val_loss: 4.8033e-04
Epoch 68/100
<span class=" -Color -Color-Bold">6/6</span> <span class=" -Color -Color-Green"></span> <span class=" -Color -Color-Bold">0s</span> 12ms/step - loss: 0.0138 - val_loss: 4.4724e-04
Epoch 69/100
<span class=" -Color -Color-Bold">6/6</span> <span class=" -Color -Color-Green"></span> <span class=" -Color -Color-Bold">0s</span> 14ms/step - loss: 0.0121 - val_loss: 4.0173e-04
Epoch 70/100
<span class=" -Color -Color-Bold">6/6</span> <span class=" -Color -Color-Green"></span> <span class=" -Color -Color-Bold">0s</span> 12ms/step - loss: 0.0125 - val_loss: 2.1253e-04
Epoch 71/100
<span class=" -Color -Color-Bold">6/6</span> <span class=" -Color -Color-Green"></span> <span class=" -Color -Color-Bold">0s</span> 11ms/step - loss: 0.0180 - val_loss: 2.5561e-04
Epoch 72/100
<span class=" -Color -Color-Bold">6/6</span> <span class=" -Color -Color-Green"></span> <span class=" -Color -Color-Bold">0s</span> 13ms/step - loss: 0.0125 - val_loss: 2.4312e-04
Epoch 73/100
<span class=" -Color -Color-Bold">6/6</span> <span class=" -Color -Color-Green"></span> <span class=" -Color -Color-Bold">0s</span> 11ms/step - loss: 0.0126 - val_loss: 3.2369e-04
Epoch 74/100
<span class=" -Color -Color-Bold">6/6</span> <span class=" -Color -Color-Green"></span> <span class=" -Color -Color-Bold">0s</span> 11ms/step - loss: 0.0128 - val_loss: 4.1372e-04
Epoch 75/100
<span class=" -Color -Color-Bold">6/6</span> <span class=" -Color -Color-Green"></span> <span class=" -Color -Color-Bold">0s</span> 13ms/step - loss: 0.0095 - val_loss: 5.8837e-04
Epoch 76/100
<span class=" -Color -Color-Bold">6/6</span> <span class=" -Color -Color-Green"></span> <span class=" -Color -Color-Bold">0s</span> 13ms/step - loss: 0.0193 - val_loss: 0.0016
Epoch 77/100
<span class=" -Color -Color-Bold">6/6</span> <span class=" -Color -Color-Green"></span> <span class=" -Color -Color-Bold">0s</span> 13ms/step - loss: 0.0135 - val_loss: 0.0016
Epoch 78/100
<span class=" -Color -Color-Bold">6/6</span> <span class=" -Color -Color-Green"></span> <span class=" -Color -Color-Bold">0s</span> 12ms/step - loss: 0.0165 - val_loss: 0.0011
Epoch 79/100
<span class=" -Color -Color-Bold">6/6</span> <span class=" -Color -Color-Green"></span> <span class=" -Color -Color-Bold">0s</span> 12ms/step - loss: 0.0134 - val_loss: 4.6392e-04
Epoch 80/100
<span class=" -Color -Color-Bold">6/6</span> <span class=" -Color -Color-Green"></span> <span class=" -Color -Color-Bold">0s</span> 13ms/step - loss: 0.0151 - val_loss: 2.2582e-04
Epoch 81/100
<span class=" -Color -Color-Bold">6/6</span> <span class=" -Color -Color-Green"></span> <span class=" -Color -Color-Bold">0s</span> 12ms/step - loss: 0.0148 - val_loss: 1.7860e-04
Epoch 82/100
<span class=" -Color -Color-Bold">6/6</span> <span class=" -Color -Color-Green"></span> <span class=" -Color -Color-Bold">0s</span> 13ms/step - loss: 0.0128 - val_loss: 2.1116e-04
Epoch 83/100
<span class=" -Color -Color-Bold">6/6</span> <span class=" -Color -Color-Green"></span> <span class=" -Color -Color-Bold">0s</span> 12ms/step - loss: 0.0115 - val_loss: 2.8068e-04
Epoch 84/100
<span class=" -Color -Color-Bold">6/6</span> <span class=" -Color -Color-Green"></span> <span class=" -Color -Color-Bold">0s</span> 11ms/step - loss: 0.0088 - val_loss: 2.9702e-04
Epoch 85/100
<span class=" -Color -Color-Bold">6/6</span> <span class=" -Color -Color-Green"></span> <span class=" -Color -Color-Bold">0s</span> 12ms/step - loss: 0.0116 - val_loss: 3.9635e-04
Epoch 86/100
<span class=" -Color -Color-Bold">6/6</span> <span class=" -Color -Color-Green"></span> <span class=" -Color -Color-Bold">0s</span> 12ms/step - loss: 0.0106 - val_loss: 3.0250e-04
Epoch 87/100
<span class=" -Color -Color-Bold">6/6</span> <span class=" -Color -Color-Green"></span> <span class=" -Color -Color-Bold">0s</span> 11ms/step - loss: 0.0165 - val_loss: 2.6141e-04
Epoch 88/100
<span class=" -Color -Color-Bold">6/6</span> <span class=" -Color -Color-Green"></span> <span class=" -Color -Color-Bold">0s</span> 12ms/step - loss: 0.0102 - val_loss: 2.2076e-04
Epoch 89/100
<span class=" -Color -Color-Bold">6/6</span> <span class=" -Color -Color-Green"></span> <span class=" -Color -Color-Bold">0s</span> 13ms/step - loss: 0.0098 - val_loss: 2.8755e-04
Epoch 90/100
<span class=" -Color -Color-Bold">6/6</span> <span class=" -Color -Color-Green"></span> <span class=" -Color -Color-Bold">0s</span> 12ms/step - loss: 0.0092 - val_loss: 3.4412e-04
Epoch 91/100
<span class=" -Color -Color-Bold">6/6</span> <span class=" -Color -Color-Green"></span> <span class=" -Color -Color-Bold">0s</span> 10ms/step - loss: 0.0115 - val_loss: 6.0356e-04
Epoch 92/100
<span class=" -Color -Color-Bold">6/6</span> <span class=" -Color -Color-Green"></span> <span class=" -Color -Color-Bold">0s</span> 13ms/step - loss: 0.0092 - val_loss: 0.0020
Epoch 93/100
<span class=" -Color -Color-Bold">6/6</span> <span class=" -Color -Color-Green"></span> <span class=" -Color -Color-Bold">0s</span> 13ms/step - loss: 0.0099 - val_loss: 0.0023
Epoch 94/100
<span class=" -Color -Color-Bold">6/6</span> <span class=" -Color -Color-Green"></span> <span class=" -Color -Color-Bold">0s</span> 11ms/step - loss: 0.0130 - val_loss: 0.0016
Epoch 95/100
<span class=" -Color -Color-Bold">6/6</span> <span class=" -Color -Color-Green"></span> <span class=" -Color -Color-Bold">0s</span> 11ms/step - loss: 0.0109 - val_loss: 9.3816e-04
Epoch 96/100
<span class=" -Color -Color-Bold">6/6</span> <span class=" -Color -Color-Green"></span> <span class=" -Color -Color-Bold">0s</span> 12ms/step - loss: 0.0147 - val_loss: 4.5706e-04
Epoch 97/100
<span class=" -Color -Color-Bold">6/6</span> <span class=" -Color -Color-Green"></span> <span class=" -Color -Color-Bold">0s</span> 12ms/step - loss: 0.0107 - val_loss: 1.7092e-04
Epoch 98/100
<span class=" -Color -Color-Bold">6/6</span> <span class=" -Color -Color-Green"></span> <span class=" -Color -Color-Bold">0s</span> 11ms/step - loss: 0.0093 - val_loss: 1.0200e-04
Epoch 99/100
<span class=" -Color -Color-Bold">6/6</span> <span class=" -Color -Color-Green"></span> <span class=" -Color -Color-Bold">0s</span> 11ms/step - loss: 0.0147 - val_loss: 1.2378e-04
Epoch 100/100
<span class=" -Color -Color-Bold">6/6</span> <span class=" -Color -Color-Green"></span> <span class=" -Color -Color-Bold">0s</span> 12ms/step - loss: 0.0107 - val_loss: 1.8677e-04
WARNING:tensorflow:5 out of the last 7 calls to &lt;function TensorFlowTrainer.make_predict_function.&lt;locals&gt;.one_step_on_data_distributed at 0x0000014859FE2520&gt; triggered tf.function retracing. Tracing is expensive and the excessive number of tracings could be due to (1) creating @tf.function repeatedly in a loop, (2) passing tensors with different shapes, (3) passing Python objects instead of tensors. For (1), please define your @tf.function outside of the loop. For (2), @tf.function has reduce_retracing=True option that can avoid unnecessary retracing. For (3), please refer to https://www.tensorflow.org/guide/function#controlling_retracing and https://www.tensorflow.org/api_docs/python/tf/function for  more details.
<span class=" -Color -Color-Bold">1/2</span> <span class=" -Color -Color-Green"></span><span class=" -Color -Color-White"></span> <span class=" -Color -Color-Bold">0s</span> 237ms/stepWARNING:tensorflow:6 out of the last 8 calls to &lt;function TensorFlowTrainer.make_predict_function.&lt;locals&gt;.one_step_on_data_distributed at 0x0000014859FE2520&gt; triggered tf.function retracing. Tracing is expensive and the excessive number of tracings could be due to (1) creating @tf.function repeatedly in a loop, (2) passing tensors with different shapes, (3) passing Python objects instead of tensors. For (1), please define your @tf.function outside of the loop. For (2), @tf.function has reduce_retracing=True option that can avoid unnecessary retracing. For (3), please refer to https://www.tensorflow.org/guide/function#controlling_retracing and https://www.tensorflow.org/api_docs/python/tf/function for  more details.
<span class=" -Color -Color-Bold">2/2</span> <span class=" -Color -Color-Green"></span> <span class=" -Color -Color-Bold">0s</span> 234ms/step
Mean Squared Error (MSE): 0.00018676869978873455
Root Mean Squared Error (RMSE): 0.013666334541080669
Mean Absolute Percentage Error (MAPE): 0.0162566003836386 %
<span class=" -Color -Color-Bold">1/1</span> <span class=" -Color -Color-Green"></span> <span class=" -Color -Color-Bold">0s</span> 50ms/step
Predicted value for next week (original scale): 16509.47711467743
</pre></div>
</div>
<img alt="_images/8ba9f3ce6f78e7cd7bece1b84788cbaa679e261f58810f502e3e265fee4fdf90.png" src="_images/8ba9f3ce6f78e7cd7bece1b84788cbaa679e261f58810f502e3e265fee4fdf90.png" />
</div>
</div>
</section>
<section id="regresi-linier-dengan-ensemble-begging">
<h2>Regresi linier dengan ensemble begging<a class="headerlink" href="#regresi-linier-dengan-ensemble-begging" title="Link to this heading">#</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">from</span> <span class="nn">sklearn.linear_model</span> <span class="kn">import</span> <span class="n">LinearRegression</span>
<span class="kn">from</span> <span class="nn">sklearn.model_selection</span> <span class="kn">import</span> <span class="n">train_test_split</span>
<span class="kn">from</span> <span class="nn">sklearn.metrics</span> <span class="kn">import</span> <span class="n">mean_squared_error</span><span class="p">,</span> <span class="n">mean_absolute_percentage_error</span>
<span class="kn">from</span> <span class="nn">sklearn.preprocessing</span> <span class="kn">import</span> <span class="n">MinMaxScaler</span>
<span class="kn">from</span> <span class="nn">sklearn.ensemble</span> <span class="kn">import</span> <span class="n">BaggingRegressor</span>


<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;sliding_windows.csv&#39;</span><span class="p">)</span>

<span class="n">df</span><span class="p">[</span><span class="s1">&#39;Date&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">to_datetime</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;Date&#39;</span><span class="p">])</span>
<span class="n">scaler</span> <span class="o">=</span> <span class="n">MinMaxScaler</span><span class="p">()</span>
<span class="n">normalized_values</span> <span class="o">=</span> <span class="n">scaler</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">df</span><span class="p">[[</span><span class="s1">&#39;minggu-1&#39;</span><span class="p">,</span> <span class="s1">&#39;minggu-2&#39;</span><span class="p">,</span> <span class="s1">&#39;minggu-3&#39;</span><span class="p">,</span> <span class="s1">&#39;minggu&#39;</span><span class="p">]])</span>

<span class="n">normalized_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">normalized_values</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;minggu-1&#39;</span><span class="p">,</span> <span class="s1">&#39;minggu-2&#39;</span><span class="p">,</span> <span class="s1">&#39;minggu-3&#39;</span><span class="p">,</span> <span class="s1">&#39;minggu&#39;</span><span class="p">])</span>
<span class="n">normalized_df</span><span class="p">[</span><span class="s1">&#39;Date&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;Date&#39;</span><span class="p">]</span>

<span class="n">X</span> <span class="o">=</span> <span class="n">normalized_df</span><span class="p">[[</span><span class="s1">&#39;minggu-1&#39;</span><span class="p">,</span> <span class="s1">&#39;minggu-2&#39;</span><span class="p">,</span> <span class="s1">&#39;minggu-3&#39;</span><span class="p">]]</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">normalized_df</span><span class="p">[</span><span class="s1">&#39;minggu&#39;</span><span class="p">]</span>  

<span class="n">X_train</span><span class="p">,</span> <span class="n">X_test</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">y_test</span> <span class="o">=</span> <span class="n">train_test_split</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">test_size</span><span class="o">=</span><span class="mf">0.2</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">42</span><span class="p">)</span>


<span class="n">base_model</span> <span class="o">=</span> <span class="n">LinearRegression</span><span class="p">()</span>
<span class="n">bagging_model</span> <span class="o">=</span> <span class="n">BaggingRegressor</span><span class="p">(</span><span class="n">estimator</span><span class="o">=</span><span class="n">base_model</span><span class="p">,</span> <span class="n">n_estimators</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">bootstrap</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="n">bagging_model</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">)</span>

<span class="n">y_pred</span> <span class="o">=</span> <span class="n">bagging_model</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_test</span><span class="p">)</span>

<span class="n">mse</span> <span class="o">=</span> <span class="n">mean_squared_error</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">y_pred</span><span class="p">)</span>
<span class="n">rmse</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">mse</span><span class="p">)</span>
<span class="n">mape</span> <span class="o">=</span> <span class="n">mean_absolute_percentage_error</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">y_pred</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Mean Squared Error: </span><span class="si">{</span><span class="n">mse</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Root Mean Squared Error: </span><span class="si">{</span><span class="n">rmse</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Mean Absolute Percentage Error (MAPE): </span><span class="si">{</span><span class="n">mape</span><span class="si">}</span><span class="s1"> %&#39;</span><span class="p">)</span>

<span class="n">last_data</span> <span class="o">=</span> <span class="n">normalized_df</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">][[</span><span class="s1">&#39;minggu-1&#39;</span><span class="p">,</span> <span class="s1">&#39;minggu-2&#39;</span><span class="p">,</span> <span class="s1">&#39;minggu-3&#39;</span><span class="p">]]</span><span class="o">.</span><span class="n">values</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span>

<span class="n">predicted_value</span> <span class="o">=</span> <span class="n">bagging_model</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">last_data</span><span class="p">)</span>

<span class="n">combined_data</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">((</span><span class="n">last_data</span><span class="o">.</span><span class="n">flatten</span><span class="p">()</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">),</span> <span class="n">predicted_value</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)),</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

<span class="n">predicted_value_original</span> <span class="o">=</span> <span class="n">scaler</span><span class="o">.</span><span class="n">inverse_transform</span><span class="p">(</span><span class="n">combined_data</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Predicted value for next week (original scale):&quot;</span><span class="p">,</span> <span class="n">predicted_value_original</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>

<span class="n">predicted_date</span> <span class="o">=</span> <span class="n">normalized_df</span><span class="p">[</span><span class="s1">&#39;Date&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">pd</span><span class="o">.</span><span class="n">Timedelta</span><span class="p">(</span><span class="n">weeks</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>  
<span class="n">predicted_row</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s1">&#39;Date&#39;</span><span class="p">:</span> <span class="p">[</span><span class="n">predicted_date</span><span class="p">],</span> 
                              <span class="s1">&#39;minggu-1&#39;</span><span class="p">:</span> <span class="n">last_data</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span> 
                              <span class="s1">&#39;minggu-2&#39;</span><span class="p">:</span> <span class="n">last_data</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">],</span> 
                              <span class="s1">&#39;minggu-3&#39;</span><span class="p">:</span> <span class="n">last_data</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">2</span><span class="p">],</span> 
                              <span class="s1">&#39;minggu&#39;</span><span class="p">:</span> <span class="n">predicted_value</span><span class="p">[</span><span class="mi">0</span><span class="p">]})</span>

<span class="n">normalized_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">normalized_df</span><span class="p">,</span> <span class="n">predicted_row</span><span class="p">],</span> <span class="n">ignore_index</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">normalized_df</span><span class="p">[</span><span class="s1">&#39;Date&#39;</span><span class="p">],</span> <span class="n">normalized_df</span><span class="p">[</span><span class="s1">&#39;minggu&#39;</span><span class="p">],</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Actual&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;blue&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">normalized_df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">X_test</span><span class="o">.</span><span class="n">index</span><span class="p">,</span> <span class="s1">&#39;Date&#39;</span><span class="p">],</span> <span class="n">y_pred</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Predicted&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">predicted_row</span><span class="p">[</span><span class="s1">&#39;Date&#39;</span><span class="p">],</span> <span class="n">predicted_row</span><span class="p">[</span><span class="s1">&#39;minggu&#39;</span><span class="p">],</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;prediski minggu depan&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;green&#39;</span><span class="p">,</span> <span class="n">s</span><span class="o">=</span><span class="mi">100</span><span class="p">)</span>  

<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;data aktul vs data prediksi&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Date&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Normalized Values&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xticks</span><span class="p">(</span><span class="n">rotation</span><span class="o">=</span><span class="mi">45</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">xticks</span><span class="p">(</span><span class="n">normalized_df</span><span class="p">[</span><span class="s1">&#39;Date&#39;</span><span class="p">][::</span><span class="nb">len</span><span class="p">(</span><span class="n">normalized_df</span><span class="p">)</span><span class="o">//</span><span class="mi">10</span><span class="p">],</span> <span class="n">rotation</span><span class="o">=</span><span class="mi">45</span><span class="p">)</span>  

<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Mean Squared Error: 0.01775639033735343
Root Mean Squared Error: 0.13325310629532594
Mean Absolute Percentage Error (MAPE): 0.18665373923223758 %
Predicted value for next week (original scale): 16766.20654698054
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>c:\Users\men\AppData\Local\Programs\Python\Python312\Lib\site-packages\sklearn\base.py:493: UserWarning: X does not have valid feature names, but BaggingRegressor was fitted with feature names
  warnings.warn(
</pre></div>
</div>
<img alt="_images/7550642d55c33b6876e834b295152c1003ed4ba23a30b6dc1fa6931c491866b7.png" src="_images/7550642d55c33b6876e834b295152c1003ed4ba23a30b6dc1fa6931c491866b7.png" />
</div>
</div>
</section>
<section id="grid-search">
<h2>Grid Search<a class="headerlink" href="#grid-search" title="Link to this heading">#</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">rmse</span><span class="p">(</span><span class="n">y_true</span><span class="p">,</span> <span class="n">y_pred</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">mean_squared_error</span><span class="p">(</span><span class="n">y_true</span><span class="p">,</span> <span class="n">y_pred</span><span class="p">))</span>
<span class="kn">import</span> <span class="nn">tensorflow</span> <span class="k">as</span> <span class="nn">tf</span>
<span class="k">def</span> <span class="nf">grid_search</span><span class="p">(</span><span class="n">input_df</span><span class="p">,</span> <span class="n">target_df</span><span class="p">,</span> <span class="n">splits</span><span class="p">,</span> <span class="n">estimators</span><span class="p">,</span> <span class="n">bootstrap</span><span class="p">,</span> <span class="n">max_samples</span><span class="p">):</span>

    <span class="n">best_rmse</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="s1">&#39;inf&#39;</span><span class="p">)</span>
    <span class="n">best_params</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="k">for</span> <span class="n">split</span> <span class="ow">in</span> <span class="n">splits</span><span class="p">:</span>
        <span class="n">X_train</span><span class="p">,</span> <span class="n">X_test</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">y_test</span> <span class="o">=</span> <span class="n">train_test_split</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">test_size</span><span class="o">=</span><span class="mf">0.2</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">42</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">estimator</span> <span class="ow">in</span> <span class="n">estimators</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">bootstrap</span> <span class="ow">in</span> <span class="n">bootstraps</span><span class="p">:</span>
                <span class="k">for</span> <span class="n">max_sample</span> <span class="ow">in</span> <span class="n">max_samples</span><span class="p">:</span>
                    <span class="n">base_model</span> <span class="o">=</span> <span class="n">LinearRegression</span><span class="p">()</span>
                    <span class="n">bagging_model</span> <span class="o">=</span> <span class="n">BaggingRegressor</span><span class="p">(</span><span class="n">estimator</span><span class="o">=</span><span class="n">base_model</span><span class="p">,</span> <span class="n">n_estimators</span><span class="o">=</span><span class="n">estimator</span><span class="p">,</span> <span class="n">bootstrap</span><span class="o">=</span><span class="n">bootstrap</span><span class="p">,</span> <span class="n">max_samples</span><span class="o">=</span><span class="n">max_sample</span><span class="p">)</span>
                    <span class="n">bagging_model</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="o">.</span><span class="n">values</span><span class="o">.</span><span class="n">ravel</span><span class="p">())</span>
                    <span class="n">y_pred</span> <span class="o">=</span> <span class="n">bagging_model</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_test</span><span class="p">)</span>
                    <span class="n">i</span><span class="o">+=</span><span class="mi">1</span>
                    <span class="n">current_rmse</span> <span class="o">=</span> <span class="n">rmse</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">y_pred</span><span class="p">)</span>
                    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Model </span><span class="si">{</span><span class="n">i</span><span class="si">}</span><span class="s1"> split: </span><span class="si">{</span><span class="n">split</span><span class="si">}</span><span class="s1">, estimator: </span><span class="si">{</span><span class="n">estimator</span><span class="si">}</span><span class="s1">, bootstrap: </span><span class="si">{</span><span class="n">bootstrap</span><span class="si">}</span><span class="s1">, max sample: </span><span class="si">{</span><span class="n">max_sample</span><span class="si">}</span><span class="s1">, RMSE: </span><span class="si">{</span><span class="n">current_rmse</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
                    <span class="k">if</span> <span class="n">current_rmse</span> <span class="o">&lt;</span> <span class="n">best_rmse</span><span class="p">:</span>
                        <span class="n">best_rmse</span> <span class="o">=</span> <span class="n">current_rmse</span>
                        <span class="n">best_model</span> <span class="o">=</span> <span class="n">bagging_model</span>
                        <span class="n">best_params</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;estimator&#39;</span><span class="p">:</span> <span class="n">estimator</span><span class="p">,</span> <span class="s1">&#39;bootstrap&#39;</span><span class="p">:</span> <span class="n">bootstrap</span><span class="p">,</span> <span class="s1">&#39;train_sample&#39;</span><span class="p">:</span> <span class="n">split</span><span class="p">,</span> <span class="s1">&#39;max_sample&#39;</span><span class="p">:</span> <span class="n">max_sample</span><span class="p">}</span>
                    <span class="n">tf</span><span class="o">.</span><span class="n">keras</span><span class="o">.</span><span class="n">backend</span><span class="o">.</span><span class="n">clear_session</span><span class="p">()</span>
    <span class="k">return</span> <span class="n">best_params</span><span class="p">,</span> <span class="n">best_rmse</span><span class="p">,</span> <span class="n">best_model</span>

<span class="c1"># Parameter untuk Grid Search</span>
<span class="n">splits</span> <span class="o">=</span> <span class="p">[</span><span class="mf">0.7</span><span class="p">,</span> <span class="mf">0.75</span><span class="p">,</span> <span class="mf">0.8</span><span class="p">,</span> <span class="mf">0.85</span><span class="p">,</span> <span class="mf">0.9</span><span class="p">]</span>
<span class="n">estimators</span> <span class="o">=</span> <span class="p">[</span><span class="mi">10</span><span class="p">,</span> <span class="mi">20</span><span class="p">,</span> <span class="mi">50</span><span class="p">,</span> <span class="mi">100</span><span class="p">]</span>
<span class="n">bootstraps</span> <span class="o">=</span> <span class="p">[</span><span class="kc">True</span><span class="p">,</span> <span class="kc">False</span><span class="p">]</span>
<span class="n">max_samples</span> <span class="o">=</span> <span class="p">[</span><span class="mf">0.8</span><span class="p">,</span> <span class="mf">0.9</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">]</span>

<span class="n">best_params</span><span class="p">,</span> <span class="n">best_rmse</span><span class="p">,</span> <span class="n">best_model</span> <span class="o">=</span> <span class="n">grid_search</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">splits</span><span class="p">,</span> <span class="n">estimators</span><span class="p">,</span> <span class="n">bootstraps</span><span class="p">,</span> <span class="n">max_samples</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Model 1 split: 0.7, estimator: 10, bootstrap: True, max sample: 0.8, RMSE: 0.13209272020721333
WARNING:tensorflow:From c:\Users\men\AppData\Local\Programs\Python\Python312\Lib\site-packages\keras\src\backend\common\global_state.py:82: The name tf.reset_default_graph is deprecated. Please use tf.compat.v1.reset_default_graph instead.

Model 2 split: 0.7, estimator: 10, bootstrap: True, max sample: 0.9, RMSE: 0.13290502586691075
Model 3 split: 0.7, estimator: 10, bootstrap: True, max sample: 1.0, RMSE: 0.13289008117730217
Model 4 split: 0.7, estimator: 10, bootstrap: False, max sample: 0.8, RMSE: 0.13231846998453223
Model 5 split: 0.7, estimator: 10, bootstrap: False, max sample: 0.9, RMSE: 0.13260382183513605
Model 6 split: 0.7, estimator: 10, bootstrap: False, max sample: 1.0, RMSE: 0.1322743608458132
Model 7 split: 0.7, estimator: 20, bootstrap: True, max sample: 0.8, RMSE: 0.13341172145773594
Model 8 split: 0.7, estimator: 20, bootstrap: True, max sample: 0.9, RMSE: 0.13207095025220994
Model 9 split: 0.7, estimator: 20, bootstrap: True, max sample: 1.0, RMSE: 0.13316547466789894
Model 10 split: 0.7, estimator: 20, bootstrap: False, max sample: 0.8, RMSE: 0.13277887235932623
Model 11 split: 0.7, estimator: 20, bootstrap: False, max sample: 0.9, RMSE: 0.1323322094363148
Model 12 split: 0.7, estimator: 20, bootstrap: False, max sample: 1.0, RMSE: 0.13227436084581323
Model 13 split: 0.7, estimator: 50, bootstrap: True, max sample: 0.8, RMSE: 0.13286908696536318
Model 14 split: 0.7, estimator: 50, bootstrap: True, max sample: 0.9, RMSE: 0.13324680195123723
Model 15 split: 0.7, estimator: 50, bootstrap: True, max sample: 1.0, RMSE: 0.13256869633174592
Model 16 split: 0.7, estimator: 50, bootstrap: False, max sample: 0.8, RMSE: 0.13273312880582216
Model 17 split: 0.7, estimator: 50, bootstrap: False, max sample: 0.9, RMSE: 0.13223383835506308
Model 18 split: 0.7, estimator: 50, bootstrap: False, max sample: 1.0, RMSE: 0.13227436084581326
Model 19 split: 0.7, estimator: 100, bootstrap: True, max sample: 0.8, RMSE: 0.1333624709392006
Model 20 split: 0.7, estimator: 100, bootstrap: True, max sample: 0.9, RMSE: 0.13284082715152626
Model 21 split: 0.7, estimator: 100, bootstrap: True, max sample: 1.0, RMSE: 0.1328839874089545
Model 22 split: 0.7, estimator: 100, bootstrap: False, max sample: 0.8, RMSE: 0.13225678822734352
Model 23 split: 0.7, estimator: 100, bootstrap: False, max sample: 0.9, RMSE: 0.13229776150963848
Model 24 split: 0.7, estimator: 100, bootstrap: False, max sample: 1.0, RMSE: 0.13227436084581293
Model 25 split: 0.75, estimator: 10, bootstrap: True, max sample: 0.8, RMSE: 0.13301575408728986
Model 26 split: 0.75, estimator: 10, bootstrap: True, max sample: 0.9, RMSE: 0.13221663570017697
Model 27 split: 0.75, estimator: 10, bootstrap: True, max sample: 1.0, RMSE: 0.1321497196792128
Model 28 split: 0.75, estimator: 10, bootstrap: False, max sample: 0.8, RMSE: 0.13214484453020958
Model 29 split: 0.75, estimator: 10, bootstrap: False, max sample: 0.9, RMSE: 0.1323493729882881
Model 30 split: 0.75, estimator: 10, bootstrap: False, max sample: 1.0, RMSE: 0.1322743608458132
Model 31 split: 0.75, estimator: 20, bootstrap: True, max sample: 0.8, RMSE: 0.13371871267240903
Model 32 split: 0.75, estimator: 20, bootstrap: True, max sample: 0.9, RMSE: 0.13323037960347067
Model 33 split: 0.75, estimator: 20, bootstrap: True, max sample: 1.0, RMSE: 0.1331666047728299
Model 34 split: 0.75, estimator: 20, bootstrap: False, max sample: 0.8, RMSE: 0.13245974165659352
Model 35 split: 0.75, estimator: 20, bootstrap: False, max sample: 0.9, RMSE: 0.1322961005616093
Model 36 split: 0.75, estimator: 20, bootstrap: False, max sample: 1.0, RMSE: 0.13227436084581323
Model 37 split: 0.75, estimator: 50, bootstrap: True, max sample: 0.8, RMSE: 0.13401205973650512
Model 38 split: 0.75, estimator: 50, bootstrap: True, max sample: 0.9, RMSE: 0.13355508542823558
Model 39 split: 0.75, estimator: 50, bootstrap: True, max sample: 1.0, RMSE: 0.13391235945095253
Model 40 split: 0.75, estimator: 50, bootstrap: False, max sample: 0.8, RMSE: 0.13253451758437498
Model 41 split: 0.75, estimator: 50, bootstrap: False, max sample: 0.9, RMSE: 0.1322402917897177
Model 42 split: 0.75, estimator: 50, bootstrap: False, max sample: 1.0, RMSE: 0.13227436084581326
Model 43 split: 0.75, estimator: 100, bootstrap: True, max sample: 0.8, RMSE: 0.13255082145458255
Model 44 split: 0.75, estimator: 100, bootstrap: True, max sample: 0.9, RMSE: 0.13337367494677713
Model 45 split: 0.75, estimator: 100, bootstrap: True, max sample: 1.0, RMSE: 0.13273463922127055
Model 46 split: 0.75, estimator: 100, bootstrap: False, max sample: 0.8, RMSE: 0.13255815226719175
Model 47 split: 0.75, estimator: 100, bootstrap: False, max sample: 0.9, RMSE: 0.13240168139838018
Model 48 split: 0.75, estimator: 100, bootstrap: False, max sample: 1.0, RMSE: 0.13227436084581293
Model 49 split: 0.8, estimator: 10, bootstrap: True, max sample: 0.8, RMSE: 0.13340927761210616
Model 50 split: 0.8, estimator: 10, bootstrap: True, max sample: 0.9, RMSE: 0.13280945258500026
Model 51 split: 0.8, estimator: 10, bootstrap: True, max sample: 1.0, RMSE: 0.13367234780480913
Model 52 split: 0.8, estimator: 10, bootstrap: False, max sample: 0.8, RMSE: 0.1326903512810239
Model 53 split: 0.8, estimator: 10, bootstrap: False, max sample: 0.9, RMSE: 0.1321874674762938
Model 54 split: 0.8, estimator: 10, bootstrap: False, max sample: 1.0, RMSE: 0.1322743608458132
Model 55 split: 0.8, estimator: 20, bootstrap: True, max sample: 0.8, RMSE: 0.13326555062618273
Model 56 split: 0.8, estimator: 20, bootstrap: True, max sample: 0.9, RMSE: 0.1345887217062495
Model 57 split: 0.8, estimator: 20, bootstrap: True, max sample: 1.0, RMSE: 0.1334030516355904
Model 58 split: 0.8, estimator: 20, bootstrap: False, max sample: 0.8, RMSE: 0.13249777107657196
Model 59 split: 0.8, estimator: 20, bootstrap: False, max sample: 0.9, RMSE: 0.132388947638813
Model 60 split: 0.8, estimator: 20, bootstrap: False, max sample: 1.0, RMSE: 0.13227436084581323
Model 61 split: 0.8, estimator: 50, bootstrap: True, max sample: 0.8, RMSE: 0.13302565819856907
Model 62 split: 0.8, estimator: 50, bootstrap: True, max sample: 0.9, RMSE: 0.13303975506438867
Model 63 split: 0.8, estimator: 50, bootstrap: True, max sample: 1.0, RMSE: 0.13333547870877488
Model 64 split: 0.8, estimator: 50, bootstrap: False, max sample: 0.8, RMSE: 0.13242043132034517
Model 65 split: 0.8, estimator: 50, bootstrap: False, max sample: 0.9, RMSE: 0.13221193969132108
Model 66 split: 0.8, estimator: 50, bootstrap: False, max sample: 1.0, RMSE: 0.13227436084581326
Model 67 split: 0.8, estimator: 100, bootstrap: True, max sample: 0.8, RMSE: 0.13343155604841264
Model 68 split: 0.8, estimator: 100, bootstrap: True, max sample: 0.9, RMSE: 0.13294910383158695
Model 69 split: 0.8, estimator: 100, bootstrap: True, max sample: 1.0, RMSE: 0.13271652542492254
Model 70 split: 0.8, estimator: 100, bootstrap: False, max sample: 0.8, RMSE: 0.1325873884409329
Model 71 split: 0.8, estimator: 100, bootstrap: False, max sample: 0.9, RMSE: 0.13235788731966885
Model 72 split: 0.8, estimator: 100, bootstrap: False, max sample: 1.0, RMSE: 0.13227436084581293
Model 73 split: 0.85, estimator: 10, bootstrap: True, max sample: 0.8, RMSE: 0.13546329548955663
Model 74 split: 0.85, estimator: 10, bootstrap: True, max sample: 0.9, RMSE: 0.13210764771343916
Model 75 split: 0.85, estimator: 10, bootstrap: True, max sample: 1.0, RMSE: 0.13323322253928363
Model 76 split: 0.85, estimator: 10, bootstrap: False, max sample: 0.8, RMSE: 0.1321635087820919
Model 77 split: 0.85, estimator: 10, bootstrap: False, max sample: 0.9, RMSE: 0.13205639855922807
Model 78 split: 0.85, estimator: 10, bootstrap: False, max sample: 1.0, RMSE: 0.1322743608458132
Model 79 split: 0.85, estimator: 20, bootstrap: True, max sample: 0.8, RMSE: 0.13322676985654378
Model 80 split: 0.85, estimator: 20, bootstrap: True, max sample: 0.9, RMSE: 0.13182705556543894
Model 81 split: 0.85, estimator: 20, bootstrap: True, max sample: 1.0, RMSE: 0.13280932361444564
Model 82 split: 0.85, estimator: 20, bootstrap: False, max sample: 0.8, RMSE: 0.1324264602999585
Model 83 split: 0.85, estimator: 20, bootstrap: False, max sample: 0.9, RMSE: 0.13217170531300865
Model 84 split: 0.85, estimator: 20, bootstrap: False, max sample: 1.0, RMSE: 0.13227436084581323
Model 85 split: 0.85, estimator: 50, bootstrap: True, max sample: 0.8, RMSE: 0.1324452953846208
Model 86 split: 0.85, estimator: 50, bootstrap: True, max sample: 0.9, RMSE: 0.13208689313657768
Model 87 split: 0.85, estimator: 50, bootstrap: True, max sample: 1.0, RMSE: 0.13240848314596737
Model 88 split: 0.85, estimator: 50, bootstrap: False, max sample: 0.8, RMSE: 0.13253271732738495
Model 89 split: 0.85, estimator: 50, bootstrap: False, max sample: 0.9, RMSE: 0.13233649539729148
Model 90 split: 0.85, estimator: 50, bootstrap: False, max sample: 1.0, RMSE: 0.13227436084581326
Model 91 split: 0.85, estimator: 100, bootstrap: True, max sample: 0.8, RMSE: 0.13323202601064843
Model 92 split: 0.85, estimator: 100, bootstrap: True, max sample: 0.9, RMSE: 0.13268990485901622
Model 93 split: 0.85, estimator: 100, bootstrap: True, max sample: 1.0, RMSE: 0.13247284459627934
Model 94 split: 0.85, estimator: 100, bootstrap: False, max sample: 0.8, RMSE: 0.13253670318833152
Model 95 split: 0.85, estimator: 100, bootstrap: False, max sample: 0.9, RMSE: 0.13234610809617417
Model 96 split: 0.85, estimator: 100, bootstrap: False, max sample: 1.0, RMSE: 0.13227436084581293
Model 97 split: 0.9, estimator: 10, bootstrap: True, max sample: 0.8, RMSE: 0.1345310302672385
Model 98 split: 0.9, estimator: 10, bootstrap: True, max sample: 0.9, RMSE: 0.13241529421347611
Model 99 split: 0.9, estimator: 10, bootstrap: True, max sample: 1.0, RMSE: 0.13161561895860976
Model 100 split: 0.9, estimator: 10, bootstrap: False, max sample: 0.8, RMSE: 0.13261806131431536
Model 101 split: 0.9, estimator: 10, bootstrap: False, max sample: 0.9, RMSE: 0.1322962914041615
Model 102 split: 0.9, estimator: 10, bootstrap: False, max sample: 1.0, RMSE: 0.1322743608458132
Model 103 split: 0.9, estimator: 20, bootstrap: True, max sample: 0.8, RMSE: 0.13410396140675546
Model 104 split: 0.9, estimator: 20, bootstrap: True, max sample: 0.9, RMSE: 0.1324540054861278
Model 105 split: 0.9, estimator: 20, bootstrap: True, max sample: 1.0, RMSE: 0.13346474524101817
Model 106 split: 0.9, estimator: 20, bootstrap: False, max sample: 0.8, RMSE: 0.13218453338532377
Model 107 split: 0.9, estimator: 20, bootstrap: False, max sample: 0.9, RMSE: 0.1324252334462905
Model 108 split: 0.9, estimator: 20, bootstrap: False, max sample: 1.0, RMSE: 0.13227436084581323
Model 109 split: 0.9, estimator: 50, bootstrap: True, max sample: 0.8, RMSE: 0.1331102741075284
Model 110 split: 0.9, estimator: 50, bootstrap: True, max sample: 0.9, RMSE: 0.13257455258952733
Model 111 split: 0.9, estimator: 50, bootstrap: True, max sample: 1.0, RMSE: 0.1334042961588682
Model 112 split: 0.9, estimator: 50, bootstrap: False, max sample: 0.8, RMSE: 0.132644893209844
Model 113 split: 0.9, estimator: 50, bootstrap: False, max sample: 0.9, RMSE: 0.1322806667885963
Model 114 split: 0.9, estimator: 50, bootstrap: False, max sample: 1.0, RMSE: 0.13227436084581326
Model 115 split: 0.9, estimator: 100, bootstrap: True, max sample: 0.8, RMSE: 0.1334700883305822
Model 116 split: 0.9, estimator: 100, bootstrap: True, max sample: 0.9, RMSE: 0.13256473643344216
Model 117 split: 0.9, estimator: 100, bootstrap: True, max sample: 1.0, RMSE: 0.13301275993411651
Model 118 split: 0.9, estimator: 100, bootstrap: False, max sample: 0.8, RMSE: 0.13238943747887744
Model 119 split: 0.9, estimator: 100, bootstrap: False, max sample: 0.9, RMSE: 0.1324516688834601
Model 120 split: 0.9, estimator: 100, bootstrap: False, max sample: 1.0, RMSE: 0.13227436084581293
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Parameter terbaik</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Best parameters: </span><span class="si">{</span><span class="n">best_params</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Best RMSE: </span><span class="si">{</span><span class="n">best_rmse</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Best model: </span><span class="si">{</span><span class="n">best_model</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Best parameters: {&#39;estimator&#39;: 10, &#39;bootstrap&#39;: True, &#39;train_sample&#39;: 0.9, &#39;max_sample&#39;: 1.0}
Best RMSE: 0.13161561895860976
Best model: BaggingRegressor(estimator=LinearRegression())
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">from</span> <span class="nn">sklearn.linear_model</span> <span class="kn">import</span> <span class="n">LinearRegression</span>
<span class="kn">from</span> <span class="nn">sklearn.model_selection</span> <span class="kn">import</span> <span class="n">train_test_split</span>
<span class="kn">from</span> <span class="nn">sklearn.metrics</span> <span class="kn">import</span> <span class="n">mean_squared_error</span><span class="p">,</span> <span class="n">mean_absolute_percentage_error</span>
<span class="kn">from</span> <span class="nn">sklearn.preprocessing</span> <span class="kn">import</span> <span class="n">MinMaxScaler</span>
<span class="kn">from</span> <span class="nn">sklearn.ensemble</span> <span class="kn">import</span> <span class="n">BaggingRegressor</span>

<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;sliding_windows.csv&#39;</span><span class="p">)</span>

<span class="n">df</span><span class="p">[</span><span class="s1">&#39;Date&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">to_datetime</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;Date&#39;</span><span class="p">])</span>

<span class="n">scaler</span> <span class="o">=</span> <span class="n">MinMaxScaler</span><span class="p">()</span>
<span class="n">normalized_values</span> <span class="o">=</span> <span class="n">scaler</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">df</span><span class="p">[[</span><span class="s1">&#39;minggu-1&#39;</span><span class="p">,</span> <span class="s1">&#39;minggu-2&#39;</span><span class="p">,</span> <span class="s1">&#39;minggu-3&#39;</span><span class="p">,</span> <span class="s1">&#39;minggu&#39;</span><span class="p">]])</span>

<span class="n">normalized_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">normalized_values</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;minggu-1&#39;</span><span class="p">,</span> <span class="s1">&#39;minggu-2&#39;</span><span class="p">,</span> <span class="s1">&#39;minggu-3&#39;</span><span class="p">,</span> <span class="s1">&#39;minggu&#39;</span><span class="p">])</span>
<span class="n">normalized_df</span><span class="p">[</span><span class="s1">&#39;Date&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;Date&#39;</span><span class="p">]</span>

<span class="n">X</span> <span class="o">=</span> <span class="n">normalized_df</span><span class="p">[[</span><span class="s1">&#39;minggu-1&#39;</span><span class="p">,</span> <span class="s1">&#39;minggu-2&#39;</span><span class="p">,</span> <span class="s1">&#39;minggu-3&#39;</span><span class="p">]]</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">normalized_df</span><span class="p">[</span><span class="s1">&#39;minggu&#39;</span><span class="p">]</span>  

<span class="n">X_train</span><span class="p">,</span> <span class="n">X_test</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">y_test</span> <span class="o">=</span> <span class="n">train_test_split</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">test_size</span><span class="o">=</span><span class="mf">0.2</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">42</span><span class="p">)</span>

<span class="n">base_model</span> <span class="o">=</span> <span class="n">LinearRegression</span><span class="p">()</span>
<span class="n">bagging_model</span> <span class="o">=</span> <span class="n">best_model</span>


<span class="n">bagging_model</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">)</span>

<span class="n">y_pred</span> <span class="o">=</span> <span class="n">bagging_model</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_test</span><span class="p">)</span>

<span class="n">mse</span> <span class="o">=</span> <span class="n">mean_squared_error</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">y_pred</span><span class="p">)</span>
<span class="n">rmse</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">mse</span><span class="p">)</span>
<span class="n">mape</span> <span class="o">=</span> <span class="n">mean_absolute_percentage_error</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">y_pred</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Mean Squared Error: </span><span class="si">{</span><span class="n">mse</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Root Mean Squared Error: </span><span class="si">{</span><span class="n">rmse</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Mean Absolute Percentage Error (MAPE): </span><span class="si">{</span><span class="n">mape</span><span class="si">}</span><span class="s1"> %&#39;</span><span class="p">)</span>

<span class="n">last_data</span> <span class="o">=</span> <span class="n">normalized_df</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">][[</span><span class="s1">&#39;minggu-1&#39;</span><span class="p">,</span> <span class="s1">&#39;minggu-2&#39;</span><span class="p">,</span> <span class="s1">&#39;minggu-3&#39;</span><span class="p">]]</span><span class="o">.</span><span class="n">values</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span>

<span class="n">predicted_value</span> <span class="o">=</span> <span class="n">bagging_model</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">last_data</span><span class="p">)</span>

<span class="n">combined_data</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">((</span><span class="n">last_data</span><span class="o">.</span><span class="n">flatten</span><span class="p">()</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">),</span> <span class="n">predicted_value</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)),</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

<span class="n">predicted_value_original</span> <span class="o">=</span> <span class="n">scaler</span><span class="o">.</span><span class="n">inverse_transform</span><span class="p">(</span><span class="n">combined_data</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Predicted value for next week (original scale):&quot;</span><span class="p">,</span> <span class="n">predicted_value_original</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>

<span class="n">predicted_date</span> <span class="o">=</span> <span class="n">normalized_df</span><span class="p">[</span><span class="s1">&#39;Date&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">pd</span><span class="o">.</span><span class="n">Timedelta</span><span class="p">(</span><span class="n">weeks</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span> 
<span class="n">predicted_row</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s1">&#39;Date&#39;</span><span class="p">:</span> <span class="p">[</span><span class="n">predicted_date</span><span class="p">],</span> 
                              <span class="s1">&#39;minggu-1&#39;</span><span class="p">:</span> <span class="n">last_data</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span> 
                              <span class="s1">&#39;minggu-2&#39;</span><span class="p">:</span> <span class="n">last_data</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">],</span> 
                              <span class="s1">&#39;minggu-3&#39;</span><span class="p">:</span> <span class="n">last_data</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">2</span><span class="p">],</span> 
                              <span class="s1">&#39;minggu&#39;</span><span class="p">:</span> <span class="n">predicted_value</span><span class="p">[</span><span class="mi">0</span><span class="p">]})</span>
<span class="n">normalized_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">normalized_df</span><span class="p">,</span> <span class="n">predicted_row</span><span class="p">],</span> <span class="n">ignore_index</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">normalized_df</span><span class="p">[</span><span class="s1">&#39;Date&#39;</span><span class="p">],</span> <span class="n">normalized_df</span><span class="p">[</span><span class="s1">&#39;minggu&#39;</span><span class="p">],</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Actual&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;blue&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">normalized_df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">X_test</span><span class="o">.</span><span class="n">index</span><span class="p">,</span> <span class="s1">&#39;Date&#39;</span><span class="p">],</span> <span class="n">y_pred</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Predicted&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">predicted_row</span><span class="p">[</span><span class="s1">&#39;Date&#39;</span><span class="p">],</span> <span class="n">predicted_row</span><span class="p">[</span><span class="s1">&#39;minggu&#39;</span><span class="p">],</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;prediksi minggu depan&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;green&#39;</span><span class="p">,</span> <span class="n">s</span><span class="o">=</span><span class="mi">100</span><span class="p">)</span>  

<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;data aktual vs prediksi&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Date&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Normalized Values&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xticks</span><span class="p">(</span><span class="n">rotation</span><span class="o">=</span><span class="mi">45</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xticks</span><span class="p">(</span><span class="n">normalized_df</span><span class="p">[</span><span class="s1">&#39;Date&#39;</span><span class="p">][::</span><span class="nb">len</span><span class="p">(</span><span class="n">normalized_df</span><span class="p">)</span><span class="o">//</span><span class="mi">10</span><span class="p">],</span> <span class="n">rotation</span><span class="o">=</span><span class="mi">45</span><span class="p">)</span> 

<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Mean Squared Error: 0.017657262890701908
Root Mean Squared Error: 0.13288063399420513
Mean Absolute Percentage Error (MAPE): 0.18240985761983564 %
Predicted value for next week (original scale): 16766.441118496594
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>c:\Users\men\AppData\Local\Programs\Python\Python312\Lib\site-packages\sklearn\base.py:493: UserWarning: X does not have valid feature names, but BaggingRegressor was fitted with feature names
  warnings.warn(
</pre></div>
</div>
<img alt="_images/8652150438c3242c7223ba4de83bc1683e6aaf8a12c0af5573fbd3b71e338a3a.png" src="_images/8652150438c3242c7223ba4de83bc1683e6aaf8a12c0af5573fbd3b71e338a3a.png" />
</div>
</div>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./."
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

                </article>
              

              
              
              
              
                <footer class="prev-next-footer">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="intro.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">Proyek Data Sains</p>
      </div>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#">PREDIKSI HARGA MINYAK CURAH UNTUK MENINGKATKAN KEUNTUNGAN DAN MENGURANGI KERUGIAN</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#perhitungan-manual-lstm">perhitungan manual LSTM</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#link-deploy-model-dengan-pythonanywere">link deploy model dengan pythonanywere</a></li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#pembahasan">PEMBAHASAN</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#data-understanding">1. DATA UNDERSTANDING</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#sumber-data">SUMBER DATA</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#eksplorasi-data">EKSPLORASI DATA</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#visualisasi-data">Visualisasi Data</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#struktur-dataset">STRUKTUR DATASET</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#identifikasi-kualitas-data">IDENTIFIKASI KUALITAS DATA</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#pendeteksian-missing-value">PENDETEKSIAN MISSING VALUE</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#sliding-windows">Sliding Windows</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#modelling-dengan-regresi-linier">MODELLING DENGAN REGRESI LINIER</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#mencoba-menggunakan-model-lain-lstm">mencoba menggunakan model lain(LSTM)</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#regresi-linier-dengan-ensemble-begging">Regresi linier dengan ensemble begging</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#grid-search">Grid Search</a></li>
</ul>
</li>
</ul>

  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By Andre Eka Ferdiansyah (220411100113)
</p>

  </div>
  
  <div class="footer-item">
    

  <p class="copyright">
    
       Copyright 2023.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="_static/scripts/bootstrap.js?digest=8d27b9dea8ad943066ae"></script>
<script src="_static/scripts/pydata-sphinx-theme.js?digest=8d27b9dea8ad943066ae"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>